(self["webpackChunkfsd"] = self["webpackChunkfsd"] || []).push([["test"],{

/***/ "./src/library.blocks/about-room/about-room.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/about-room/about-room.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/big-button/big-button.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/big-button/big-button.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/bordered-button/bordered-button.sass":
/*!*****************************************************************!*\
  !*** ./src/library.blocks/bordered-button/bordered-button.sass ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/bullet-list/bullet-list.sass":
/*!*********************************************************!*\
  !*** ./src/library.blocks/bullet-list/bullet-list.sass ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/cal/cal.sass":
/*!*****************************************!*\
  !*** ./src/library.blocks/cal/cal.sass ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/card/card.sass":
/*!*******************************************!*\
  !*** ./src/library.blocks/card/card.sass ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/check-list/check-list.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/check-list/check-list.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/check/check.sass":
/*!*********************************************!*\
  !*** ./src/library.blocks/check/check.sass ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/comment/comment.sass":
/*!*************************************************!*\
  !*** ./src/library.blocks/comment/comment.sass ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/date-dropdown/date-dropdown.sass":
/*!*************************************************************!*\
  !*** ./src/library.blocks/date-dropdown/date-dropdown.sass ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/dropdown/dropdown.sass":
/*!***************************************************!*\
  !*** ./src/library.blocks/dropdown/dropdown.sass ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/filter-date-dropdown/filter-date-dropdown.sass":
/*!***************************************************************************!*\
  !*** ./src/library.blocks/filter-date-dropdown/filter-date-dropdown.sass ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/impressions/impressions.sass":
/*!*********************************************************!*\
  !*** ./src/library.blocks/impressions/impressions.sass ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/like/like.sass":
/*!*******************************************!*\
  !*** ./src/library.blocks/like/like.sass ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/pagination/pagination.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/pagination/pagination.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/primary-button/primary-button.sass":
/*!***************************************************************!*\
  !*** ./src/library.blocks/primary-button/primary-button.sass ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/radio/radio.sass":
/*!*********************************************!*\
  !*** ./src/library.blocks/radio/radio.sass ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/range-label/range-label.sass":
/*!*********************************************************!*\
  !*** ./src/library.blocks/range-label/range-label.sass ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/range-slider/range-slider.sass":
/*!***********************************************************!*\
  !*** ./src/library.blocks/range-slider/range-slider.sass ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/rate/rate.sass":
/*!*******************************************!*\
  !*** ./src/library.blocks/rate/rate.sass ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/rich-check/rich-check.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/rich-check/rich-check.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/subscription-text-field/subscription-text-field.sass":
/*!*********************************************************************************!*\
  !*** ./src/library.blocks/subscription-text-field/subscription-text-field.sass ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/text-button/text-button.sass":
/*!*********************************************************!*\
  !*** ./src/library.blocks/text-button/text-button.sass ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/text-field/text-field.sass":
/*!*******************************************************!*\
  !*** ./src/library.blocks/text-field/text-field.sass ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/toggle/toggle.sass":
/*!***********************************************!*\
  !*** ./src/library.blocks/toggle/toggle.sass ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/library.blocks/watermark/watermark.sass":
/*!*****************************************************!*\
  !*** ./src/library.blocks/watermark/watermark.sass ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/pages/ui-kit/form-elements/form-elements.sass":
/*!***********************************************************!*\
  !*** ./src/pages/ui-kit/form-elements/form-elements.sass ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/common.scripts/importAll.js":
/*!*****************************************!*\
  !*** ./src/common.scripts/importAll.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* eslint-disable */
const importAll = (
  r = __webpack_require__("./src/library.blocks sync recursive .+\\.(sass|js)$")
) => {
  r.keys().forEach((k) => r(k));
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (importAll);



/***/ }),

/***/ "./src/library.blocks/bordered-button/bordered-button.js":
/*!***************************************************************!*\
  !*** ./src/library.blocks/bordered-button/bordered-button.js ***!
  \***************************************************************/
/***/ (() => {

class BorderedButton {
  constructor(root) {
    this.borderedButton = root;
    this.button = root.querySelector('.bordered-button__button');
    this.bindListeners();
  }

  bindListeners() {
    this.button.addEventListener('focus', this.handleButtonFocus.bind(this));
    this.button.addEventListener('blur', this.handleButtonBlur.bind(this));
  }

  handleButtonFocus() {
    this.borderedButton.classList.add('bordered-button_focused');
  }

  handleButtonBlur() {
    this.borderedButton.classList.remove('bordered-button_focused');
  }
}

document.querySelectorAll('.bordered-button')
  .forEach((b) => new BorderedButton(b));



/***/ }),

/***/ "./src/library.blocks/cal/Tables.js":
/*!******************************************!*\
  !*** ./src/library.blocks/cal/Tables.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Tables": () => (/* binding */ Tables)
/* harmony export */ });
class Tables {
  constructor(tables) {
    this.tables = tables;
    this.index = 0;
    this.rowSize = this.tables[0].rows[0].cells.length;
    this.lastCellIndex = this.rowSize - 1;
  }

  decreaseIndex() {
    if (this.index === 0) { return; }
    this.index -= 1;
  }

  increaseIndex() {
    if (this.index === this.tables.length - 1) { return; }
    this.index += 1;
  }

  * genCoordsInOrder(coord, reference, compareFunc = () => true) {
    let currentCoord = coord;
    while (compareFunc(currentCoord, reference)) {
      yield currentCoord;
      currentCoord = this.getNextCoord(currentCoord);
    }
  }

  getCoordsForward(coord, n) {
    if (n === 0) { return coord; }
    return this.getCoordsForward(this.getNextCoord(coord), --n);
  }

  getCoordsAgo(coord, n) {
    if (n === 0) { return coord; }
    return this.getCoordsAgo(this.getPrevCoord(coord), --n);
  }

  getNextCoord(coord) {
    return coord[2] < this.lastCellIndex 
      ? [coord[0], coord[1], coord[2] + 1] 
      : this.getCell([coord[0], coord[1] + 1, 0]) 
        ? [coord[0], coord[1] + 1, 0] 
        : [coord[0] + 1, 0, 0];
  }

  getPrevCoord(coord) {
    return coord[2] > 0 
      ? [coord[0], coord[1], coord[2] - 1] 
      : coord[1] > 0
        ? [coord[0], coord[1] - 1, this.lastCellIndex]
        : [
          coord[0] - 1,
          this.getLastRowIndex(coord[0] - 1),
          this.lastCellIndex
        ];
  }

  getLastCellCoord(index) {
    return [index, this.getLastRowIndex(index), 6];
  }

  getLastRowIndex(index) {
    return this.getNRows(index) - 1;
  }

  getNRows(index) {
    return this.tables[index].rows.length;
  }

  getElemCoord(elem) {
    return [
      this.index, 
      elem.closest('tr').rowIndex, 
      elem.closest('td').cellIndex
    ];
  }

  getCoord(index, nCells) {
    return [
      index,
      Math.floor((nCells - 1) / this.rowSize),
      (nCells - 1) % this.rowSize
    ];
  }

  getCell(coord) {
    return this.tables[coord[0]]?.rows[coord[1]]?.cells[coord[2]];
  }

  static getMinCoord(coordA, coordB) {
    return Tables.makeUnnumerical(
      Math.min(Tables.makeNumerical(coordA), Tables.makeNumerical(coordB))
    );
  }

  static compareCoord(coordA, coordB) {
    return Tables.makeNumerical(coordA) - Tables.makeNumerical(coordB);
  }

  static isCoordEqual(coord, reference) {
    return Tables.makeNumerical(coord) === Tables.makeNumerical(reference);
  }

  static isCoordMore(coord, reference) {
    return Tables.makeNumerical(coord) > Tables.makeNumerical(reference);
  }

  static isCoordLess(coord, reference) {
    return Tables.makeNumerical(coord) < Tables.makeNumerical(reference);
  }

  static isCoordLessOrEqual(coord, reference) {
    return Tables.makeNumerical(coord) <= Tables.makeNumerical(reference);
  }

  static makeUnnumerical(numericalCoord) {
    return Tables.fillCoord(String(numericalCoord).split('').map(Number));
  }

  static fillCoord(coord, length = coord.length) {
    if (length >= 3) { return coord; }
    return Tables.fillCoord([0, ...coord], ++length);
  }

  static makeNumerical(coord) {
    return +coord.reduce((res, dimension) => res + dimension, '');
  }

  static getLastItem(list) {
    return list[list.length - 1];
  }
}





/***/ }),

/***/ "./src/library.blocks/cal/cal.js":
/*!***************************************!*\
  !*** ./src/library.blocks/cal/cal.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Tables_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tables.js */ "./src/library.blocks/cal/Tables.js");


class Cal extends _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables {
  constructor(root) {
    super(root.getElementsByClassName('js-cal__main-table'));
    this.root = root;
    this.monthFormater = new Intl.DateTimeFormat('ru', { month: 'long' });
    this.readyDateEvent = new CustomEvent(
      'ready-date',
      { 
        bubbles: true, 
        detail: 'date range is ready (start and end range data filled)'
      }
    );
    this.nextMonthBtn = this.root.querySelector('.js-cal__next-month-btn');
    this.cancleBtn = this.root.querySelector('.js-cal__cancle-btn');
    this.tableContainer = this.root.querySelector('.js-cal__table-container');
    this.error = this.root.querySelector('.js-cal__error');
    this.errorMessage = this.error.innerText;
    this.error.innerText = '';
    this.template = this.tableContainer.innerHTML;
    this.monthDisplay = this.root.querySelector('.js-cal__month');
    this.yearDisplay = this.root.querySelector('.js-cal__year');
    this.step = parseInt(getComputedStyle(this.tableContainer).width);
    this.rangeCounter = 0;
    this.range = [];
    this.startRange = [];
    this.endRange = [];
    this.selectedMod = 'cal__day_selected';
    this.startRangeMod = 'cal__day_start-range';
    this.endRangeMod = 'cal__day_end-range';
    this.selectedBtnMod = 'cal__day-btn_selected';
    this.nextMonthBtnMod = 'cal__day-btn_next-month';
    this.prevMonthBtnMod = 'cal__day-btn_prev-month';
    this.todayBtnMod = 'cal__day-btn_todays';
    this.hash = this.root.dataset.hash || 'cal0';
    this.initDates = this.getInitDates();
    this.root.dataset.date = this.initDates.date || '';
    const now = new Date(this.initDates.date || Date());
    this.year = now.getFullYear();
    this.month = now.getMonth();
    this.init(now);
  }

  getInitDates() {
    const data = this.root.dataset;
    const source = data.date || data.startDate 
      ? data 
      : JSON.parse(sessionStorage.getItem(this.hash));
    return {
      date: source?.date,
      startDate: source?.startDate,
      endDate: source?.endDate
    };
  }

  init(now) {
    this.modifyTodaysBtn(now);
    this.disableBtsn(now);
    this.fillTable(this.index);
    this.clearTable(this.index);
    this.bindListenerOnLastBtn(this.index);
    this.insertFillClearTable(this.index + 1);
    this.updateMonthDisplayValue();
    this.updateYearDisplayValue();
    this.bindListeners();
    if (Cal.checkDateIsValid(this.initDates.startDate)) { return; }
    this.setInitialRange(this.initDates.startDate);
    if (Cal.checkDateIsValid(this.initDates.endDate)) { return; }
    this.setInitialRange(this.initDates.endDate);
  }

  modifyTodaysBtn(now) {
    this.getButton(
      this.getCoord( 0, this.getPrevMonthNDay(0) + now.getDate())
    )
      .classList.add(this.todayBtnMod);
  }

  disableBtsn(now) {
    [...this.genCoordsInOrder(
      [0, 0, 0],
      this.getCoord( 0, this.getPrevMonthNDay(0) + now.getDate()),
      _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordLess,
    )]
      .forEach((coord) => (
        this.getButton(coord).disabled = true
      ));
  }

  setInitialRange(dateStr) {
    const btnDate = new Date(dateStr);
    const index = this.getIndex(btnDate);
    this.insertFillClearTableNthTimes(index);
    const coord = this.getCoord(
      index, 
      this.getPrevMonthNDay(index) + btnDate.getDate()
    );
    const btn = this.getButton(coord);
    this.index = index;
    btn.click();
    this.index = 0;
  }

  getIndex(rangeDate) {
    return (rangeDate.getFullYear() - this.year) * 12 
      - this.month + rangeDate.getMonth();
  }

  insertFillClearTableNthTimes(n) {
    if (!n) { return; }
    while (this.tables.length != n + 2) {
      this.insertFillClearTable(this.tables.length);
    }
  }

  insertFillClearTable(index) {
    this.insertTemplate();
    this.fillTable(index);
    this.clearTable(index);
    this.bindListenerOnLastBtn(index);
    this.bindListenerOnFirstBtn(index);
  }

  updateMonthDisplayValue() {
    this.monthDisplay.innerText = this.monthFormater
      .format(new Date(this.year, this.month + this.index))
      .replace(/^./, (s) => s.toUpperCase());
  }

  updateYearDisplayValue() {
    this.yearDisplay.innerText = new Date(
      this.year, this.month + this.index
    ).getFullYear();
  }

  bindListeners() {
    this.root.querySelector('.js-cal__prev-month-btn')
      .addEventListener('click', this.handlePrevMonthBtnClick.bind(this));
    this.nextMonthBtn
      .addEventListener('click', this.handleNextMonthBtnClick.bind(this));
    this.nextMonthBtn
      .addEventListener('keydown', this.handleNextMonthBtnKeydown.bind(this));
    this.cancleBtn
      .addEventListener('click', this.handleCancleBtnClick.bind(this));
    this.cancleBtn
      .addEventListener('keydown', this.handleCancleBtnKeydown.bind(this));
    this.root.querySelector('.js-cal__apply-btn')
      .addEventListener('click', this.handleApplyBtnClick.bind(this));
    this.tableContainer
      .addEventListener('click', this.handleTableContainerClick.bind(this));
  }

  bindListenerOnLastBtn(index) {
    this.getButton(this.getLastCellCoord(index))
      .addEventListener('keydown', this.handleLastDayBtnKeydown.bind(this));
  }

  bindListenerOnFirstBtn(index) {
    this.getButton([index, 0, 0])
      .addEventListener('keydown', this.handleFirstDayBtnKeydown.bind(this));
  }

  handlePrevMonthBtnClick() {
    if (this.index == 0) { return; }
    this.decreaseIndex();
    this.changeDisplayedMonth();
    this.updateMonthDisplayValue();
    this.updateYearDisplayValue();
  }

  handleNextMonthBtnClick() {
    this.increaseIndex();
    this.changeDisplayedMonth();
    this.updateMonthDisplayValue();
    this.updateYearDisplayValue();
    if (this.index === this.tables.length - 1) {
      this.insertFillClearTable(this.index + 1);
    }
  }

  handleCancleBtnClick() {
    this.clearRange();
    this.clearRangeData();
  }

  handleApplyBtnClick() {
    this.setSessStorDate();
    this.error.innerText = this.errorMessage;
    if (this.isEndRange()) {
      this.root.dispatchEvent(this.readyDateEvent);
      this.error.innerText = '';
    }
  }

  setSessStorDate() {
    sessionStorage.setItem(
      this.hash, 
      JSON.stringify({
        date: this.root.dataset.date,
        startDate: this.root.dataset.startDate,
        endDate: this.root.dataset.endDate
      })
    );
  }

  handleLastDayBtnKeydown(e) {
    if (e.code === 'Tab' && !e.shiftKey) {
      e.preventDefault();
      this.cancleBtn.firstElementChild.focus();
    }
  }

  handleFirstDayBtnKeydown(e) {
    if (e.code === 'Tab' && e.shiftKey) {
      e.preventDefault();
      this.nextMonthBtn.focus();
    }
  }

  handleCancleBtnKeydown(e) {
    if (e.code === 'Tab' && e.shiftKey) {
      e.preventDefault();
      this.getButton(this.getLastCellCoord(this.index)).focus();
    }
  }

  handleNextMonthBtnKeydown(e) {
    if (e.code === 'Tab' && !e.shiftKey && this.index !== 0) { 
      e.preventDefault();
      this.getButton([this.index, 0, 0]).focus();
    }
  }

  handleTableContainerClick(e) {
    const btn = e.target;
    if (!btn.classList.contains('cal__day-btn')) { return; }
    const isSelected = btn.classList.toggle(this.selectedBtnMod);
    if (isSelected === false) {
      this.clearRange();
      this.clearRangeData();
      this.removeDataIsReady();
      return;
    }
    if (this.isEndRange()) { 
      this.clearRange(); 
      this.clearRangeData();
    }
    this.rangeCounter += 1;
    const btnCoord = this.getElemCoord(btn);
    const firstRowBtn = this.getButton([btnCoord[0], btnCoord[1], 0]);
    const lastRowBtn = this.getButton([btnCoord[0], btnCoord[1], 6]);
    this.addCoordInRange(btnCoord);
    const isPrevMonthbtn = btn.classList.contains(this.prevMonthBtnMod);
    const isNextMonthBtn = btn.classList.contains(this.nextMonthBtnMod);
    const shouldSelectedPrevMonth = firstRowBtn
      .classList.contains(this.prevMonthBtnMod);
    const shouldSelectedNextMonth = lastRowBtn
      .classList.contains(this.nextMonthBtnMod);
    if (isPrevMonthbtn || shouldSelectedPrevMonth) {
      this.addCoordInRange(this.getCoordsAgo(btnCoord, 7));
    }
    if (isNextMonthBtn || shouldSelectedNextMonth) {
      this.addCoordInRange(this.getCoordsForward(btnCoord, 7));
    }
    this.selectLastRangeBtn();
    this.removeDataIsReady();
    if (this.isEndRange()) {
      this.orderRange();
      this.drawRange(this.range[0]);
      this.fixOrderRange();
      this.modifyRangeCells();
      this.setDataIsReady();
    }
    this.setRangeData();
  }

  drawRange(coord) {
    const nextCoord = this.searchNextRangeCoord(
      this.drawPartOfRange(
        this.genCoordsInOrder(
          coord,
          this.searchNextRangeCoord(coord) || _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(this.range),
          (
            this.getButton([coord[0], coord[1], 6])
              .classList.contains(this.nextMonthBtnMod)
              ? ((lastCoord) => (coord) => (
                _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordLessOrEqual(coord, lastCoord)
              ))(_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getMinCoord(
                this.getLastCellCoord(coord[0]),
                this.range[1]
              ))
              : _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordLessOrEqual
          ),
        )
      )
    );
    if (nextCoord) { 
      this.drawRange(
        _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordEqual(nextCoord, _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(this.range)) 
          ? [_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(this.range)[0], 0, 0] 
          : nextCoord
      ); 
    }
  }

  searchNextRangeCoord(coord) {
    return this.range.find((c) => _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordMore(c, coord));
  }

  drawPartOfRange(generator) {
    const coords = [...generator];
    coords.forEach((coord) => (
      this.getCell(coord).classList.add(this.selectedMod)
    ));
    return _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(coords);
  }

  fixOrderRange() {
    this.startRange.sort(_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.compareCoord);
    this.endRange.sort(_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.compareCoord);
    const buffer = this.startRange;
    if (_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordLess(this.startRange[0], this.endRange[0])) { return; }
    this.startRange = this.endRange;
    this.endRange = buffer;
  }

  modifyRangeCells() {
    this.startRange.forEach((coord) => {
      const cell = this.getCell(coord);
      cell.classList.remove(this.selectedMod);
      cell.classList.add(this.startRangeMod);
    });
    this.endRange.forEach((coord) => {
      const cell = this.getCell(coord);
      cell.classList.remove(this.selectedMod);
      cell.classList.add(this.endRangeMod);
    });
  }

  clearRange() {
    if (this.rangeCounter === 2) {
      [...this.genCoordsInOrder(
        this.range[0], 
        _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(this.range),
        _Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.isCoordLessOrEqual,
      )]
        .forEach((coord) => (
          this.getCell(coord).classList.remove(this.selectedMod)
        ));
    }
    [...this.startRange, ...this.endRange].forEach((coord) => {
      const cell = this.getCell(coord);
      cell.classList.remove(this.startRangeMod);
      cell.classList.remove(this.endRangeMod);
      this.getButton(coord).classList.remove(this.selectedBtnMod);
    });

    this.rangeCounter = 0;
    this.range = [];
    this.startRange = [];
    this.endRange = [];
  }

  setRangeData() {
    this.root.dataset.startDate = (
      Cal.formatDate(this.getDateFromCoord(
        this.startRange.find(this.isPresentDayBtn.bind(this))
      ))
    );
    if (this.endRange.length != 0) {
      this.root.dataset.endDate = (
        Cal.formatDate(this.getDateFromCoord(
          this.endRange.find(this.isPresentDayBtn.bind(this))
        ))
      );
    }
  }

  clearRangeData() {
    this.root.dataset.startDate = '';
    this.root.dataset.endDate = '';
  }

  setDataIsReady() {
    this.root.setAttribute('data-date-is-ready', '');
  }

  removeDataIsReady() {
    this.root.removeAttribute('data-date-is-ready');
  }

  isPresentDayBtn(coord) {
    const button = this.getButton(coord);
    const isNext = button.classList.contains(this.nextMonthBtnMod);
    const isPrev = button.classList.contains(this.prevMonthBtnMod);
    return !(isNext || isPrev);
  }

  addCoordInRange(coord) {
    this.getLastRange().push(coord);
  }

  selectLastRangeBtn() {
    this.getButton(_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.getLastItem(this.getLastRange()))
      .classList.add(this.selectedBtnMod);
  }

  getLastRange() {
    return this.isStartRange() ? this.startRange : this.endRange;
  }

  isStartRange() {
    return this.rangeCounter === 1;
  }

  isEndRange() {
    return this.rangeCounter === 2;
  }

  orderRange() {
    this.range = [...this.startRange, ...this.endRange]
      .sort(_Tables_js__WEBPACK_IMPORTED_MODULE_0__.Tables.compareCoord);
  }

  changeDisplayedMonth() {
    this.tables[0].style.marginLeft = `${-this.index * this.step}px`;
  }

  fillTable(index) {
    const gen = this.genCoordsInOrder(
      [index, 0, 0], 
      [index, this.getLastRowIndex(index), 6]
    );
    Cal.getPrevMonthDay(
      Cal.getMonthLastDay(this.year, this.month + index - 1),
      this.getPrevMonthNDay(index)
    ).forEach((day) => {
      const btn = this.getButton(gen.next().value);
      btn.innerText = day;
      btn.classList.add(this.prevMonthBtnMod);
    });
    Cal.getPresentDay(this.getPresentNDay(index)).forEach((day) => (
      this.getButton(gen.next().value).innerText = day
    ));
    Cal.getNextMonthDay(this.getNextMonthNDay(index)).forEach((day) => {
      const btn = this.getButton(gen.next().value);
      btn.innerText = day;
      btn.classList.add(this.nextMonthBtnMod);
    });
  }

  clearTable(index) {
    const nFilledRows = Math.ceil(
      (this.getPrevMonthNDay(index) + this.getPresentNDay(index)) / 7
    );
    for (let row = 5; row >= nFilledRows; row--) {
      this.tables[index].rows[row].remove();
    }
  }

  insertTemplate() {
    this.tableContainer.insertAdjacentHTML('beforeend', this.template);
  }

  getNextMonthNDay(index) {
    return 7 - Cal.getWeekDay(
      this.year, 
      this.month + index,
      Cal.getMonthLastDay(this.year, this.month + index)
    );
  }

  getPresentNDay(index) {
    return Cal.getMonthLastDay(this.year, this.month + index);
  }

  getPrevMonthNDay(index) {
    return Cal.getWeekDay(this.year, this.month + index) - 1;
  }

  getButton(coord) {
    return this.getCell(coord).firstElementChild;
  }

  getDateFromCoord(coord) {
    return new Date(
      this.year,
      this.month + coord[0], 
      coord[1] * 7 + coord[2] + 1 - this.getPrevMonthNDay(coord[0])
    );
  }

  static checkDateIsValid(dateStr) {
    return new Date(dateStr).toString() === 'Invalid Date';
  }

  static getNextMonthDay(nextMonthNDay) {
    return Array(nextMonthNDay).fill(1).map((d, idx) => d + idx);
  }

  static getPresentDay(presentMonthNDay) {
    return [...Array(presentMonthNDay).keys()].map((d) => d + 1);
  }

  static getPrevMonthDay(prevLastDate, prevMonthNDay) {
    return Array(prevMonthNDay)
      .fill(prevLastDate)
      .map((d, idx) => d - idx)
      .reverse();
  }

  static getWeekDay(year, month, day = 1) {
    return new Date(year, month, day).getDay() || 7;
  }

  static getMonthLastDay(year, month) {
    return new Date(year, month + 1, 0).getDate();
  }

  static formatDate(date) {
    return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;
  }
}

document.querySelectorAll('.js-cal').forEach((cal) => new Cal(cal));



/***/ }),

/***/ "./src/library.blocks/check-list/check-list.js":
/*!*****************************************************!*\
  !*** ./src/library.blocks/check-list/check-list.js ***!
  \*****************************************************/
/***/ (() => {

class CheckList {
  constructor(root) {
    this.root = root;
    this.button = this.root.querySelector('.check-list__button');
    this.bindListeners();
  }

  bindListeners() {
    this.button.addEventListener('click', () => this.handleButtonClick());
  }

  handleButtonClick() {
    this.root.classList.toggle('check-list_open');
  }
}

document.querySelectorAll('.check-list').forEach((cl) => new CheckList(cl));


/***/ }),

/***/ "./src/library.blocks/date-dropdown/date-dropdown.js":
/*!***********************************************************!*\
  !*** ./src/library.blocks/date-dropdown/date-dropdown.js ***!
  \***********************************************************/
/***/ (() => {

class DateDropdown {
  constructor(root) {
    this.dateFormater = new Intl.DateTimeFormat('ru');
    this.calWrapper = root.querySelector('.js-date-dropdown__cal-wrapper');
    this.cal = this.calWrapper.firstElementChild;
    this.startBtn = root.querySelector('.js-date-dropdown__start-btn');
    this.endBtn = root.querySelector('.js-date-dropdown__end-btn');
    this.startSignature = this.startBtn
      .querySelector('.js-date-dropdown__date-signature');
    this.endSignature = this.endBtn
      .querySelector('.js-date-dropdown__date-signature');
    this.mask = this.startSignature.innerText;
    this.endMask = this.endSignature.innerText;
    this.observer = new MutationObserver(
      this.handleCalAttrsChanges.bind(this)
    );
    this.observer.observe(this.cal, {attributes: true});
    this.bindListeners();
    this.handleCalAttrsChanges();
  }

  handleCalAttrsChanges() {
    this.handleCalStartAttrsChanges();
    this.handleCalEndAttrsChanges();
  }

  handleCalStartAttrsChanges() {
    this.updateStartSignature(new Date(this.getStartDate()));
  }

  handleCalEndAttrsChanges() {
    this.updateEndSignature(new Date(this.getEndDate()));
  }

  updateStartSignature(date) {
    this.checkDate(date) 
      ? this.changeStartDateSignatyre(this.mask) 
      : this.changeStartDateSignatyre(this.formateDate(date));
  }

  updateEndSignature(date) {
    this.checkDate(date) 
      ? this.changeEndDateSignatyre(this.endMask) 
      : this.changeEndDateSignatyre(this.formateDate(date));
  }

  getStartDate() {
    return this.cal.dataset.startDate;
  }

  getEndDate() {
    return this.cal.dataset.endDate;
  }

  checkDate(date) {
    return date.toString() === 'Invalid Date';
  }

  formateDate(date) {
    return this.dateFormater.format(date);
  }

  changeStartDateSignatyre(dateStr) {
    this.startSignature.innerText = dateStr;
  }

  changeEndDateSignatyre(dateStr) {
    this.endSignature.innerText = dateStr;
  }

  bindListeners() {
    this.startBtn.addEventListener('click', this.handleBtnClick.bind(this));
    this.endBtn.addEventListener('click', this.handleBtnClick.bind(this));
    this.calWrapper
      .addEventListener('ready-date', this.handleBtnClick.bind(this));
  }

  handleBtnClick() {
    this.calWrapper.classList.toggle('date-dropdown__cal-wrapper_hidden');
  }
}

document.querySelectorAll('.js-date-dropdown')
  .forEach((dd) => new DateDropdown(dd));



/***/ }),

/***/ "./src/library.blocks/dropdown/dropdown.js":
/*!*************************************************!*\
  !*** ./src/library.blocks/dropdown/dropdown.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _glossary_Glossary_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./glossary/Glossary.js */ "./src/library.blocks/dropdown/glossary/Glossary.js");
/* harmony import */ var _glossary_glossarys_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./glossary/glossarys.js */ "./src/library.blocks/dropdown/glossary/glossarys.js");



class Dropdown {
  constructor(dropdown, glossary = {}) {
    this.glossary = new _glossary_Glossary_js__WEBPACK_IMPORTED_MODULE_0__.default(glossary);
    this.dropdown = dropdown;
    this.expandButton = dropdown.querySelector('.js-dropdown__expand-button');
    this.signature = dropdown.querySelector('.js-dropdown__signature');
    this.defaultSignature = this.signature.innerText;
    this.list = dropdown.querySelector('.js-dropdown__list');
    this.decreaseButtons = dropdown
      .querySelectorAll('.js-dropdown__decrease-button');
    this.increaseButtons = dropdown
      .querySelectorAll('.js-dropdown__increase-button');
    this.counters = [
      ...dropdown.querySelectorAll('.js-dropdown__counter')
    ];
    this.sectionNames = Array.from(
      dropdown.querySelectorAll('.js-dropdown__section-name'),
      (section) => section.innerText
    );
    this.applyButton = dropdown.querySelector('.js-dropdown__apply-button');
    this.cancelButton = dropdown.querySelector('.js-dropdown__cancel-button');
    this.row = 0;
    this.value = 0;
    this.countersSum = 0;
    this.signatureInterfaces = this.getSignatureInterfaces();
    this.bindListeners();
    this.hash = this.dropdown.dataset.hash;
    this.setCounterValues(this.getInitValues());
    if (this.dropdown.hasAttribute('data-open')) {
      this.expandButton.click(); 
    }
  }

  getSignatureInterfaces() {
    return this.glossary.terms.reduce((interfaces, term) => { 
      const splitedTerm = term.split('+');
      return [
        ...interfaces, 
        {
          getValue: () => (
            splitedTerm.reduce((sum, splitedTerm) => (
              +this.counters[this.sectionNames.indexOf(splitedTerm)]
                .innerText
              + sum
            ), 0)
          ),
          getName: () => (
            this.sectionNames.find((name) => name === splitedTerm[0])
          )
        }
      ];
    }, []);
  }

  getInitValues() {
    return this.dropdown.dataset.counterValues 
      || sessionStorage.getItem(this.hash)
      || '';
  }

  bindListeners() {
    this.expandButton.addEventListener(
      'click',
      this.handleExpandButtonClick.bind(this)
    );
    this.decreaseButtons.forEach((b) => (
      b.addEventListener('click', this.handleDecreaseButtonClick.bind(this))
    ));
    this.increaseButtons.forEach((b) => (
      b.addEventListener('click', this.handleIncreaseButtonClick.bind(this))
    ));
    this.applyButton && this.applyButton.addEventListener(
      'click', 
      this.handeApplyButtonClick.bind(this)
    );
    this.cancelButton && this.cancelButton.addEventListener(
      'click',
      this.handleCancelButtonClick.bind(this)
    );
  }

  handleExpandButtonClick() {
    this.expandButton.classList.toggle('dropdown__expand-button_pressed');
    this.list.classList.toggle('dropdown__list_hidden');
  }

  handleDecreaseButtonClick(e) {
    this.update(e.target);
    if (this.value === 0) { return; }
    if (this.value === 1) { this.toggleDecreaseButtonMod(); }
    this.changeCounterValue(-1);
    this.updateSignature(this.signatureInterfaces);
    this.countersSum -= 1;
    if (this.countersSum === 0) {
      this.toggleCancelButtonMod();
    }
  }

  handleIncreaseButtonClick(e) {
    this.update(e.target);
    if (this.value === 0) { this.toggleDecreaseButtonMod(); }
    this.changeCounterValue(1);
    this.updateSignature(this.signatureInterfaces);
    this.countersSum += 1;
    if (this.countersSum === 1) {
      this.toggleCancelButtonMod();
    }
  }

  handeApplyButtonClick() {
    this.expandButton.classList.toggle('dropdown__expand-button_pressed');
    this.list.classList.toggle('dropdown__list_hidden');
    this.hash && sessionStorage.setItem(
      this.hash, 
      this.counters.reduce((res, c) => `${res} ${c.innerText}`, '')
    );
  }

  handleCancelButtonClick() {
    this.resetCounters();
    this.countersSum = 0;
    this.signature.innerText = this.defaultSignature;
    this.addDecreseButtonsMod();
    this.toggleCancelButtonMod();
  }

  setCounterValues(values) {
    (values.match(/\d+/g) || []).forEach((v, idx) => (
      this.clickOnButtonNthTimes(+v, this.increaseButtons[idx])
    ));
  }

  clickOnButtonNthTimes(n, button) {
    if (n <= 0) { return; }
    button.click();
    this.clickOnButtonNthTimes(--n, button);
  }

  changeCounterValue(diff) {
    return this.counters[this.row].innerText = this.value + diff;
  }

  resetCounters() {
    this.counters.forEach((c) => c.innerText = 0);
  }

  toggleDecreaseButtonMod() {
    this.decreaseButtons[this.row]
      .classList.toggle('dropdown__decrease-button_disabled');
  }

  addDecreseButtonsMod() {
    this.decreaseButtons.forEach((b) => (
      b.classList.add('dropdown__decrease-button_disabled')
    ));
  }

  toggleCancelButtonMod() {
    if (this.cancelButton) {
      this.cancelButton.classList.toggle('dropdown__cancel-button_hidden');
    }
  }

  updateSignature(interfaces = this.signatureInterfaces) {
    this.signature.innerText = interfaces.reduce((res, i) => {
      const value = i.getValue();
      if (value === 0) { return res; }
      const part = `${value} ${
        this.glossary.getDefinition(i.getName(), value)
      }`;
      return res === '' ? part : `${res}, ${part}`;
    }, '') || this.defaultSignature;
  }

  getRow(button) {
    return Math.max(
      [...this.decreaseButtons].indexOf(button),
      [...this.increaseButtons].indexOf(button),
      0
    );
  }

  update(button) {
    this.row = this.getRow(button);
    this.value = +this.counters[this.row].innerText;
  }
}

const getSplitedData = (dropdown) => dropdown.dataset.glossary.split(', ');
const compare = (data) => (glossary) => { 
  const terms = Object.keys(glossary);
  return data.filter((d) => terms.indexOf(d) == -1).length == 0;
};
const initDropdowns = (dropdowns, glossarys) => (
  dropdowns.forEach((d) => (
    new Dropdown(d, glossarys.find((compare(getSplitedData(d)))))
  ))
);

initDropdowns(
  document.querySelectorAll('.js-dropdown'), 
  Object.values(_glossary_glossarys_js__WEBPACK_IMPORTED_MODULE_1__)
);



/***/ }),

/***/ "./src/library.blocks/dropdown/glossary/Glossary.js":
/*!**********************************************************!*\
  !*** ./src/library.blocks/dropdown/glossary/Glossary.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
class Glossary {
  constructor(glossary = {}) {
    this.glossary = glossary;
    this.terms = Object.keys(glossary);
  }

  static checkForm1(digit) {
    return digit === 1;
  }

  static checkForm2(digit) {
    return digit > 1 && digit < 5;
  }

  static checkForm3(digit, n) {
    return (digit === 0 || digit > 4) || (n > 9 && n < 20);
  }

  static compare(searchWord, term) {
    return term.trim().split('+').find((t) => t === searchWord);
  }

  defineShape(n) {
    const lastDigit = +String(n).slice(-1);
    return [
      Glossary.checkForm1(lastDigit),
      Glossary.checkForm2(lastDigit),
      Glossary.checkForm3(lastDigit, +String(n).slice(-2))
    ].lastIndexOf(true);
  }

  findTerm(word) {
    return this.terms.find(Glossary.compare.bind(null, word));
  }

  getDefinition(testWord, numeral) {
    return (
      this.glossary[this.findTerm(testWord)] || []
    )[this.defineShape(numeral)] || testWord;
  }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Glossary);



/***/ }),

/***/ "./src/library.blocks/dropdown/glossary/glossarys.js":
/*!***********************************************************!*\
  !*** ./src/library.blocks/dropdown/glossary/glossarys.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "g1": () => (/* binding */ g1),
/* harmony export */   "g2": () => (/* binding */ g2)
/* harmony export */ });
const g1 = {
  спальни: ['спальня', 'спальни', 'спален'],
  кровати: ['кровать', 'кровати', 'кроватей'],
  'ванные комнаты': ['ванная комната', 'ванные комнаты', 'ванных комнат'],
};

const g2 = {
  'взрослые+дети': ['гость', 'гостя', 'гостей'],
  'младенцы': ['младенец', 'младенца', 'младенцев']
};



/***/ }),

/***/ "./src/library.blocks/filter-date-dropdown/filter-date-dropdown.js":
/*!*************************************************************************!*\
  !*** ./src/library.blocks/filter-date-dropdown/filter-date-dropdown.js ***!
  \*************************************************************************/
/***/ (() => {

class FilterDateDropdown {
  constructor(root) {
    this.calWrapper = root
      .querySelector('.js-filter-date-dropdown__cal-wrapper');
    this.cal = this.calWrapper.firstElementChild;
    this.btn = root.querySelector('.js-filter-date-dropdown__btn');
    this.sign = root.querySelector('.js-filter-date-dropdown__sign');
    this.dateFormater = new Intl.DateTimeFormat(
      'ru', 
      {day: 'numeric', month: 'short'}
    );
    this.observer = new MutationObserver(this.handleCalAttrsChanges.bind(this));
    this.observer.observe(this.cal, {attributes: true});
    this.bindListeners();
    this.handleCalAttrsChanges();
  }

  handleCalAttrsChanges() {
    if (this.cal.hasAttribute('data-date-is-ready')) {
      const data = this.cal.dataset;
      if (data.startDate === '') { return; }
      this.sign.innerText = `${this.formateDate(new Date(data.startDate))} - ${
        this.formateDate(new Date(data.endDate))
      }`;
    }
  }

  bindListeners() {
    const bindedHandleBtnClick = this.handleBtnClick.bind(this);
    this.btn.addEventListener('click', bindedHandleBtnClick);
    this.calWrapper.addEventListener('ready-date', bindedHandleBtnClick);
  }

  handleBtnClick() {
    this.btn.classList.toggle('filter-date-dropdown__btn_pressed');
    this.calWrapper
      .classList.toggle('filter-date-dropdown__cal-wrapper_hidden');
  }

  formateDate(date) {
    return this.dateFormater.format(date).slice(0, -1);
  }
}

document.querySelectorAll('.js-filter-date-dropdown')
  .forEach((fdd) => new FilterDateDropdown(fdd));



/***/ }),

/***/ "./src/library.blocks/impressions/impressions.js":
/*!*******************************************************!*\
  !*** ./src/library.blocks/impressions/impressions.js ***!
  \*******************************************************/
/***/ (() => {

const template = (
  `<svg 
    class="impressions__circle" 
    width="120"
    height="120"
    viewBox="-2 0 124 120">
    <defs>
      <linearGradient id="amazing" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#FFE39C;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#FFBA9C;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="cool" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#6FCF97;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#66D2EA;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="bad" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#BC9CFF;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#8BA4F9;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="veryBad" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#909090;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#3D4975;stop-opacity:1" />
      </linearGradient>
    </defs> 
  </svg>`
);
const getTemplateElem = (template) => {
  const temp = document.createElement('div');
  temp.insertAdjacentHTML('afterbegin', template);
  return temp.firstChild;
};
const insertArc = (templateElem) => (arc) => {
  templateElem.insertAdjacentHTML('beforeend', arc);
  return templateElem;
};
const parseData = (root) => {
  const {amazing = 0, cool = 0, bad = 0, veryBad = 0} = root.dataset;
  return [+amazing, +cool, +bad, +veryBad];
};
const getNGaps = (rating) => rating.filter((r) => r).length;
const getFullAngle = (gap) => (nGaps) => 360 - gap * nGaps;
const getTotalMarks = (rating) => rating.reduce((s, r) => s + r);
const getAngles = (totalMarks) => (fullAngle) => (rate) => (
  rate / totalMarks * fullAngle
);
const getStartAngle = (gap) => (_, idx, angles) => (
  angles.slice(0, idx)
    .filter((angle) => angle)
    .reduce((acc, angle) => acc + angle + gap, gap / 2)
);
const getClass = (idx) => (
  {0: 'amazing', 1: 'cool', 2: 'bad', 3: 'veryBad'}[idx]
);
const getPoint = (r) => (angle) => {
  const angleRad = (angle + 90) * Math.PI / 180;
  const x = r * Math.cos(angleRad) + r;
  const y = Math.abs(r * Math.sin(angleRad) - r);
  return x + ' ' + y;
};
const getArc = (gap) => (r) => (getStartAngle) => (getPoint) => 
  (angle, idx, angles) => (
    `<path 
      class=${getClass(idx)}
      d="M${getPoint(getStartAngle(angle, idx, angles))} 
        A${r} ${r} 0 ${angle > 180 ? 1 : 0}
        0 ${getPoint(
      (getStartAngle(angle, idx + 1, angles) || 360 + gap / 2) - gap, r
    )}" 
      fill="none"
      stroke=url(#${getClass(idx)})
      stroke-width="4"
     />`
  );
const getCircle = (r) => (rating) => (
  `<circle cx=${r} cy=${r} r=${r} 
  stroke=url(#${getClass(rating.findIndex((r) => r))}) 
  stroke-width="4" fill="none"/>`
);
const insertSign = (totalMarks) => (templateElem) => (
  templateElem.insertAdjacentHTML(
    'beforeend', 
    `<text 
      class="impressions__room-number" 
      text-anchor="middle" 
      x="60" 
      y="65" 
      fill="url(#bad)">${totalMarks}
    </text>
    <text 
      class="impressions__room-votes" 
      text-anchor="middle" 
      x="60" 
      y="81" 
      fill="url(#bad)">голосов
    </text>`
  ), templateElem
);
const main = (gap) => (r) => (root) => (rating) => (totalMarks) => ( 
  root.insertAdjacentElement(
    'beforeend', 
    insertSign (totalMarks) (
      rating.filter((x) => x).length == 1
        ? insertArc (getTemplateElem (template)) (getCircle (r) (rating))
        : rating.map(
          getAngles (totalMarks) (
            getFullAngle (gap) (getNGaps (rating))
          )
        ).reduce((template, a, idx, angles) => (
          a == 0 ? template : insertArc (template) (
            getArc (gap) (r) (getStartAngle (gap)) (getPoint (r)) (
              a, idx, angles
            )
          )
        ), getTemplateElem (template))
    )
  )
);
const bind = (main) => (a) => (fn) => {
  const newA = fn(a);
  return bind(main(newA)) (newA);
};
const init = (root) => (
  bind (main(4)(60)(root)) (root) (parseData) (getTotalMarks)
);
document.querySelectorAll('.js-impressions__circle-container')
  .forEach((c) => init(c));



/***/ }),

/***/ "./src/library.blocks/like/like.js":
/*!*****************************************!*\
  !*** ./src/library.blocks/like/like.js ***!
  \*****************************************/
/***/ (() => {

class Like {
  constructor(like) {
    this.like = like;
    this.counter = this.like.querySelector('.js-like__counter');
    this.btn = this.like.querySelector('.js-like__btn');
    this.bindListeners();
  }

  bindListeners() {
    this.like.addEventListener('click', this.handleLikeClick.bind(this));
    this.btn.addEventListener('focus', this.handleBtnFocus.bind(this));
    this.btn.addEventListener('blur', this.handleBtnBlur.bind(this));
  }

  handleLikeClick() {
    this.like.classList.toggle('like_pressed') 
      ? this.counter.innerText -= -1
      : this.counter.innerText -= 1;
    this.handleBtnFocus();
  }

  handleBtnFocus() {
    this.handleBtnBlur();
    this.like.classList.contains('like_pressed') 
      ? this.like.classList.add('like_focused-pressed') 
      : this.like.classList.add('like_focused');
  }

  handleBtnBlur() {
    this.like.classList.remove('like_focused-pressed');
    this.like.classList.remove('like_focused');
  }
}

document.querySelectorAll('.js-like').forEach((l) => new Like(l));



/***/ }),

/***/ "./src/library.blocks/range-label/range-label.js":
/*!*******************************************************!*\
  !*** ./src/library.blocks/range-label/range-label.js ***!
  \*******************************************************/
/***/ (() => {

class RangeLable {
  constructor(root) {
    this.slider = document.getElementById(root.dataset.sliderId);
    if (!this.slider) { return; }
    this.start = root.querySelector('.range-label__start');
    this.end = root.querySelector('.range-label__end');
    this.observer = new MutationObserver(
      this.handleSliderChangeAttrs.bind(this)
    );
    this.observer.observe(this.slider, { attributes: true });
    this.formater = new Intl.NumberFormat(
      root.dataset.formaterLang, 
      {
        maximumFractionDigits: RangeLable.calcDecimalPlaces(+root.dataset.step),
        minimumFractionDigits: 0,
        ...root.dataset.formaterOpt 
          ? JSON.parse(root.dataset.formaterOpt) 
          : {
            style: 'currency',
            currency: 'RUB',
          }
      }
    );
    const data = root.dataset;
    this.max = +data.max;
    this.min = +data.min;
    this.step = +data.step;
    this.handleSliderChangeAttrs();
  }

  handleSliderChangeAttrs() {
    this.updateStartValue(
      this.format(
        this.calcValue(this.slider.dataset.bsp)
      )
    );
    this.updateEndValue(
      this.format(
        this.calcValue(this.slider.dataset.bep)
      )
    );
  }

  updateStartValue(value) {
    this.start.innerText = value;
  }

  updateEndValue(value) {
    this.end.innerText = value;
  }

  format(preValue) {
    return this.formater.format(preValue).replace(/\s(?!\d)/, '');
  }

  calcValue(pos) {
    return Math.min(
      this.max,
      Math.floor(pos * (this.max - this.min + this.step) / this.step) 
      * this.step + this.min
    );
  }

  static calcDecimalPlaces(n) {
    const sn = String(n);
    const pointIndex = sn.indexOf('.');
    return pointIndex === -1 ? 0 : sn.slice(pointIndex + 1).length;
  }
}

document.querySelectorAll('.range-label').forEach((rl) => new RangeLable(rl));



/***/ }),

/***/ "./src/library.blocks/range-slider/range-slider.js":
/*!*********************************************************!*\
  !*** ./src/library.blocks/range-slider/range-slider.js ***!
  \*********************************************************/
/***/ (() => {

const iff = (predicate, fn) => (...args) => predicate() && fn(...args);
const pipe = (...fns) => fns.reduceRight((a, b) => (...args) => a(b(...args)));

const resizeBar = (bar, state) => () => (
  bar.style.width = `${
    (state.pb() + state.getRelBw() / 2) * 100 / state.getRatio() 
  }%`
);

const calcPosition = (container, state) => (e) => {
  const rect = container.getBoundingClientRect();
  return (e.x - rect.x - state.getShift() + state.b().offset) / rect.width;
};

const moveButton = (btn, state) => (preposition) => {
  const position = Math.min(
    state.b().max, Math.max(preposition, state.b().min)
  );
  btn.style.left = `${position * 100}%`;
  state.setB(position);
  return position;
};

const bindPointer = (elem, id) => elem.setPointerCapture(id);

const handlePointerDown = (state) => (e) => {
  bindPointer(e.target, e.pointerId);
  state.setShift(e.x - e.target.getBoundingClientRect().x);
  state.retrigger();
};

const handleLostPointer = (state) => () => state.retrigger();

const newState = (bw, track) => {
  const s = {
    isTrigered: false,
    shift: 0,
    stretchRatio: 1,
    bs: { max: 1, min: 0, offset: bw },
    be: { max: 1, min: 0, offset: 0 },
  };
  const getRelBw = () => bw / track.getBoundingClientRect().width;
  const setStretchRatio = (relBw) => (s.stretchRatio = 1 + relBw * 2);
  const transformTrack = (ratio = s.stretchRatio) => (
    track.style.transform = `scale(${ratio})`
  );
  transformTrack(1); 
  setStretchRatio(getRelBw());
  transformTrack();
  return (type = 'bs') => {
    const extendedButtonI = {
      getTrigger() { return s.isTrigered; },
      getShift() { return s.shift; }
    };
    const extendedPBI = {
      getRatio() { return s.stretchRatio; },
      getRelBw() { return getRelBw(); },
    };
    return {
      bs: {
        b() { return s.bs; },
        setB(pos) { s.be.min = pos; },
        ...extendedButtonI
      },
      be: {
        b() { return s.be; },
        setB(pos) { s.bs.max = pos; },
        ...extendedButtonI
      },
      pbs: {
        pb() { return s.be.min; },
        ...extendedPBI
      },
      pbe: {
        pb() { return 1 - s.bs.max; },
        ...extendedPBI
      },
      t: {
        retrigger() { s.isTrigered = !s.isTrigered; },
        setShift(value) { s.shift = value; },
      },
    }[type];
  };
};

const bindListeners = (root) => {
  const container = root.querySelector('.js-range-slider__container');
  const track = root.querySelector('.js-range-slider__body');
  const bs = root.querySelector('.js-range-slider__button_start-range');
  const be = root.querySelector('.js-range-slider__button_end-range');
  const pbs = root.querySelector('.js-range-slider__progress-bar_start');
  const pbe = root.querySelector('.js-range-slider__progress-bar_end');
  const state = newState(bs.getBoundingClientRect().width, track);
  const {bsp, bep} = root.dataset;
  const moveHandlerS = pipe(
    calcPosition(container, state('bs')),
    moveButton(bs, state('bs')),
    (pos) => root.dataset.bsp = pos,
    resizeBar(pbs, state('pbs'))
  );
  const moveHandlerE = pipe(
    calcPosition(container, state('be')),
    moveButton(be, state('be')),
    (pos) => root.dataset.bep = pos,
    resizeBar(pbe, state('pbe'))
  );
  pipe(moveButton(bs, state('bs')), resizeBar(pbs, state('pbs')))(bsp);
  pipe(moveButton(be, state('be')), resizeBar(pbe, state('pbe')))(bep);
  [bs, be].forEach((b) => {
    b.addEventListener('pointerdown', handlePointerDown(state('t')));
    b.addEventListener('lostpointercapture', handleLostPointer(state('t')));
  });
  bs.addEventListener('pointermove', iff(state().getTrigger, moveHandlerS));
  be.addEventListener('pointermove', iff(state().getTrigger, moveHandlerE));
};

document.querySelectorAll('.js-range-slider')
  .forEach((root) => bindListeners(root));



/***/ }),

/***/ "./src/library.blocks/subscription-text-field/subscription-text-field.js":
/*!*******************************************************************************!*\
  !*** ./src/library.blocks/subscription-text-field/subscription-text-field.js ***!
  \*******************************************************************************/
/***/ (() => {

class SubscriptionTextField {
  constructor(elem) {
    this.textField = elem;
    this.input = this.textField
      .querySelector('.js-subscription-text-field__input');
    this.button = this.textField
      .querySelector('.js-subscription-text-field__button');
    this.bindListeners();
  }

  bindListeners() {
    this.input.addEventListener(
      'focus', 
      this.handleSubscriptionTextFieldInputFocus.bind(this)
    );
    this.input.addEventListener(
      'blur',
      this.handleSubscriptionTextFieldInputBlur.bind(this)
    );
    this.button.addEventListener(
      'focus',
      this.handleSubscriptionTextFieldInputFocus.bind(this)
    );
    this.button.addEventListener(
      'blur',
      this.handleSubscriptionTextFieldInputBlur.bind(this)
    );
  }

  handleSubscriptionTextFieldInputFocus() {
    this.textField.classList.add('subscription-text-field_active');
  }

  handleSubscriptionTextFieldInputBlur() {
    this.textField.classList.remove('subscription-text-field_active');
  }
}

document.querySelectorAll('.js-subscription-text-field')
  .forEach((i) => new SubscriptionTextField(i));



/***/ }),

/***/ "./src/library.blocks/text-field/text-field_masked.js":
/*!************************************************************!*\
  !*** ./src/library.blocks/text-field/text-field_masked.js ***!
  \************************************************************/
/***/ (() => {

class MaskedTextField {
  constructor(input) {
    this.input = input;
    this.template = '31.12.2099';
    this.index = -1;
    this.prepValue = '';
    this.amountPoints = 0;
    this.templateValue = '';
    this.inputValue = '';
    this.bindListeners();
  }

  bindListeners() {
    this.input.addEventListener('input', this.handleTextFieldInput.bind(this));
  }

  handleTextFieldInput() {
    const diff = this.getValueIndex() - this.index;
    const lastSymb = this.input.value.slice(-1);
    if (diff > 0) { this.processInput(lastSymb); }
    if (diff < 0 && !(/\d/).test(lastSymb)) { this.removeLastCharacter(); }
    this.index = this.getValueIndex();
  }

  processInput(symb) {
    this.updateValues();
    if (/\d/.test(symb)) { 
      return this.handleDigit();
    }
    if (symb == '.') { 
      return this.handlePoint();
    }
    if (symb == ' ') {
      return this.autocomplete();
    }
    this.removeLastCharacter();
  }

  updateValues() {
    this.prepValue = this.trimNonDigit(this.input.value);
    this.amountPoints = (this.prepValue.match(/\./g) || []).length;
    this.templateValue = this.getValue(this.template)[this.amountPoints];
    this.inputValue = this.getValue(this.prepValue).pop();
  }

  handleDigit() {
    if (this.template[this.getValueIndex()] == '.') {
      return this.setValue(this.concatString(
        ...this.splitString(this.input.value, this.getValueIndex()),
        '.'
      ));
    }
    if (
      this.inputValue.length == this.templateValue.length 
      && +this.inputValue == 0
    ) {
      return this.setValue(
        this.prepValue.slice(0, this.prepValue.lastIndexOf(this.inputValue))
        + this.inputValue.slice(0, -1)
        + '1'
      );
    }
    if (+this.inputValue > +this.templateValue) {
      return this.setValue(
        this.prepValue.slice(0, this.prepValue.lastIndexOf(this.inputValue))
        + this.templateValue
      );
    }
  }

  handlePoint() {
    if (+this.inputValue > +this.templateValue) {
      return this.setValue(
        this.prepValue.slice(0, -this.templateValue.length) 
        + this.templateValue 
        + '.'
      );
    }
    if (this.inputValue.length == 0 || this.templateValue.length == 4) {
      return this.setValue(this.prepValue);
    }
    if (this.inputValue.length == 1 && this.templateValue.length == 2) {
      return this.addZero();
    }
    if (this.inputValue.length == 2) {
      this.setLastPoint();
    }
  }

  autocomplete() {
    if (this.inputValue.length == 1 && this.templateValue.length == 2) {
      return this.addZero();
    }
    if (this.inputValue.length == this.templateValue.length) {
      return this.setLastPoint();
    }
    if (this.templateValue.length == 4 && this.inputValue.length == 2) {
      return +this.inputValue > 21
        ? this.yearAutocomplete('19')
        : this.yearAutocomplete('20');
    }
    this.removeLastCharacter();
  }

  setLastPoint() {
    return this.setValue(this.prepValue + '.');
  }

  addZero() {
    return this.setValue((
      this.inputValue == '0' 
        ? this.prepValue + '1'
        : this.concatString(
          ...this.splitString(this.prepValue, this.prepValue.length - 1),
          '0'
        ) 
    ) + '.');
  }

  getValueIndex() {
    return this.input.value.length - 1;
  }

  setValue(value) {
    return this.input.value = value;
  }

  splitString(str, pos) {
    return [str.slice(0, pos), str.slice(pos)];
  }

  concatString(start, end, symbol = '') {
    return start + symbol + end;
  }

  trimNonDigit(str) {
    return str.replace(/[^\d]+$/, '');
  }

  removeLastCharacter() {
    return this.setValue(this.input.value.slice(0, -1));
  }

  getValue(str) {
    return str.match(/[^.]+(?=\.|$)/g) || [''];
  }

  yearAutocomplete(shortYear) {
    return this.setValue(this.concatString(
      ...this.splitString(
        this.prepValue, this.prepValue.lastIndexOf(this.inputValue)
      ),
      shortYear
    ));
  }
}

document.querySelectorAll('.js-text-field_masked')
  .forEach((input) => new MaskedTextField(input));



/***/ }),

/***/ "./src/pages/index/index.js":
/*!**********************************!*\
  !*** ./src/pages/index/index.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

/* eslint-disable */
(r) => (
  r.keys().filter((k) => !k.includes('cal')).forEach((k) => r(k))
)(__webpack_require__("./src/library.blocks sync recursive \\.sass$"));



/***/ }),

/***/ "./src/pages/ui-kit/form-elements/form-elements.js":
/*!*********************************************************!*\
  !*** ./src/pages/ui-kit/form-elements/form-elements.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _src_pages_ui_kit_form_elements_form_elements_sass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @src/pages/ui-kit/form-elements/form-elements.sass */ "./src/pages/ui-kit/form-elements/form-elements.sass");
/* harmony import */ var _src_common_scripts_importAll_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @src/common.scripts/importAll.js */ "./src/common.scripts/importAll.js");




(0,_src_common_scripts_importAll_js__WEBPACK_IMPORTED_MODULE_1__.default)();



/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvYWJvdXQtcm9vbS9hYm91dC1yb29tLnNhc3M/MTIyNiIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvYmlnLWJ1dHRvbi9iaWctYnV0dG9uLnNhc3M/NjVkZiIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvYm9yZGVyZWQtYnV0dG9uL2JvcmRlcmVkLWJ1dHRvbi5zYXNzP2I1YTciLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2J1bGxldC1saXN0L2J1bGxldC1saXN0LnNhc3M/NTc2NiIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvY2FsL2NhbC5zYXNzPzFiNDAiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NhcmQvY2FyZC5zYXNzP2ExZDIiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NoZWNrLWxpc3QvY2hlY2stbGlzdC5zYXNzPzQ1OTEiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NoZWNrL2NoZWNrLnNhc3M/NjYzMiIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvY29tbWVudC9jb21tZW50LnNhc3M/MzU3NSIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvZGF0ZS1kcm9wZG93bi9kYXRlLWRyb3Bkb3duLnNhc3M/OTkxZCIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvZHJvcGRvd24vZHJvcGRvd24uc2Fzcz8xYWNmIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9maWx0ZXItZGF0ZS1kcm9wZG93bi9maWx0ZXItZGF0ZS1kcm9wZG93bi5zYXNzPzI0YTYiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2ltcHJlc3Npb25zL2ltcHJlc3Npb25zLnNhc3M/M2M5YyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvbGlrZS9saWtlLnNhc3M/NjMzMSIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvcGFnaW5hdGlvbi9wYWdpbmF0aW9uLnNhc3M/ZDEzZSIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvcHJpbWFyeS1idXR0b24vcHJpbWFyeS1idXR0b24uc2Fzcz80Y2I2Iiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9yYWRpby9yYWRpby5zYXNzPzdlNTgiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL3JhbmdlLWxhYmVsL3JhbmdlLWxhYmVsLnNhc3M/OWRiYiIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvcmFuZ2Utc2xpZGVyL3JhbmdlLXNsaWRlci5zYXNzPzMxY2QiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL3JhdGUvcmF0ZS5zYXNzP2U2ODAiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL3JpY2gtY2hlY2svcmljaC1jaGVjay5zYXNzP2I2ZWYiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL3N1YnNjcmlwdGlvbi10ZXh0LWZpZWxkL3N1YnNjcmlwdGlvbi10ZXh0LWZpZWxkLnNhc3M/MTI2YSIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvdGV4dC1idXR0b24vdGV4dC1idXR0b24uc2Fzcz8xZTNkIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy90ZXh0LWZpZWxkL3RleHQtZmllbGQuc2Fzcz8yNGQ3Iiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy90b2dnbGUvdG9nZ2xlLnNhc3M/ZTE2MSIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3Mvd2F0ZXJtYXJrL3dhdGVybWFyay5zYXNzPzVhZjUiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL3BhZ2VzL3VpLWtpdC9mb3JtLWVsZW1lbnRzL2Zvcm0tZWxlbWVudHMuc2Fzcz85YzgzIiwid2VicGFjazovL2ZzZC8uL3NyYy9jb21tb24uc2NyaXB0cy9pbXBvcnRBbGwuanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2JvcmRlcmVkLWJ1dHRvbi9ib3JkZXJlZC1idXR0b24uanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NhbC9UYWJsZXMuanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NhbC9jYWwuanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2NoZWNrLWxpc3QvY2hlY2stbGlzdC5qcyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvZGF0ZS1kcm9wZG93bi9kYXRlLWRyb3Bkb3duLmpzIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9kcm9wZG93bi9kcm9wZG93bi5qcyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvZHJvcGRvd24vZ2xvc3NhcnkvR2xvc3NhcnkuanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2Ryb3Bkb3duL2dsb3NzYXJ5L2dsb3NzYXJ5cy5qcyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvZmlsdGVyLWRhdGUtZHJvcGRvd24vZmlsdGVyLWRhdGUtZHJvcGRvd24uanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL2ltcHJlc3Npb25zL2ltcHJlc3Npb25zLmpzIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9saWtlL2xpa2UuanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL2xpYnJhcnkuYmxvY2tzL3JhbmdlLWxhYmVsL3JhbmdlLWxhYmVsLmpzIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9yYW5nZS1zbGlkZXIvcmFuZ2Utc2xpZGVyLmpzIiwid2VicGFjazovL2ZzZC8uL3NyYy9saWJyYXJ5LmJsb2Nrcy9zdWJzY3JpcHRpb24tdGV4dC1maWVsZC9zdWJzY3JpcHRpb24tdGV4dC1maWVsZC5qcyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvbGlicmFyeS5ibG9ja3MvdGV4dC1maWVsZC90ZXh0LWZpZWxkX21hc2tlZC5qcyIsIndlYnBhY2s6Ly9mc2QvLi9zcmMvcGFnZXMvaW5kZXgvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZnNkLy4vc3JjL3BhZ2VzL3VpLWtpdC9mb3JtLWVsZW1lbnRzL2Zvcm0tZWxlbWVudHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7OztBQ0FBO0FBQ0E7QUFDQSxNQUFNLDBFQUFvRDtBQUMxRDtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsU0FBUyxFQUFDOzs7Ozs7Ozs7Ozs7QUNQekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDJCQUEyQixRQUFRO0FBQ25DO0FBQ0E7O0FBRUE7QUFDQSxnREFBZ0QsUUFBUTtBQUN4RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCLGNBQWM7QUFDaEM7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQixjQUFjO0FBQ2hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQixjQUFjO0FBQ3BDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVnQjs7Ozs7Ozs7Ozs7Ozs7O0FDcEltQjs7QUFFbkMsa0JBQWtCLDhDQUFNO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxnQkFBZ0I7QUFDeEU7QUFDQTtBQUNBLE87QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxRQUFRO0FBQ2pFO0FBQ0EsdURBQXVELFFBQVE7QUFDL0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDBEQUFrQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBCQUEwQixRQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FB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QUFFQTs7Ozs7Ozs7Ozs7O0FDN2dCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7OztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxpQkFBaUI7QUFDdEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FDbkY4QztBQUNPOztBQUVyRDtBQUNBLHFDQUFxQztBQUNyQyx3QkFBd0IsMERBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNkJBQTZCO0FBQ2hELDZDQUE2Qyw0QkFBNEI7QUFDekU7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMEI7QUFDQTtBQUNBO0FBQ0Esc0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzlKQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLG1FQUE2Qzs7Ozs7Ozs7Ozs7Ozs7OztBQ0hhOztBQUVIOztBQUV6RCx5RUFBUyIsImZpbGUiOiJ0ZXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLyogZXNsaW50LWRpc2FibGUgKi9cbmNvbnN0IGltcG9ydEFsbCA9IChcbiAgciA9IHJlcXVpcmUuY29udGV4dCgnQGxpYnJhcnkvJywgdHJ1ZSwgLy4rXFwuKHNhc3N8anMpJC8pXG4pID0+IHtcbiAgci5rZXlzKCkuZm9yRWFjaCgoaykgPT4gcihrKSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBpbXBvcnRBbGw7XG5cbiIsImNsYXNzIEJvcmRlcmVkQnV0dG9uIHtcbiAgY29uc3RydWN0b3Iocm9vdCkge1xuICAgIHRoaXMuYm9yZGVyZWRCdXR0b24gPSByb290O1xuICAgIHRoaXMuYnV0dG9uID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuYm9yZGVyZWQtYnV0dG9uX19idXR0b24nKTtcbiAgICB0aGlzLmJpbmRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGJpbmRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLmhhbmRsZUJ1dHRvbkZvY3VzLmJpbmQodGhpcykpO1xuICAgIHRoaXMuYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLmhhbmRsZUJ1dHRvbkJsdXIuYmluZCh0aGlzKSk7XG4gIH1cblxuICBoYW5kbGVCdXR0b25Gb2N1cygpIHtcbiAgICB0aGlzLmJvcmRlcmVkQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2JvcmRlcmVkLWJ1dHRvbl9mb2N1c2VkJyk7XG4gIH1cblxuICBoYW5kbGVCdXR0b25CbHVyKCkge1xuICAgIHRoaXMuYm9yZGVyZWRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnYm9yZGVyZWQtYnV0dG9uX2ZvY3VzZWQnKTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYm9yZGVyZWQtYnV0dG9uJylcbiAgLmZvckVhY2goKGIpID0+IG5ldyBCb3JkZXJlZEJ1dHRvbihiKSk7XG5cbiIsImNsYXNzIFRhYmxlcyB7XG4gIGNvbnN0cnVjdG9yKHRhYmxlcykge1xuICAgIHRoaXMudGFibGVzID0gdGFibGVzO1xuICAgIHRoaXMuaW5kZXggPSAwO1xuICAgIHRoaXMucm93U2l6ZSA9IHRoaXMudGFibGVzWzBdLnJvd3NbMF0uY2VsbHMubGVuZ3RoO1xuICAgIHRoaXMubGFzdENlbGxJbmRleCA9IHRoaXMucm93U2l6ZSAtIDE7XG4gIH1cblxuICBkZWNyZWFzZUluZGV4KCkge1xuICAgIGlmICh0aGlzLmluZGV4ID09PSAwKSB7IHJldHVybjsgfVxuICAgIHRoaXMuaW5kZXggLT0gMTtcbiAgfVxuXG4gIGluY3JlYXNlSW5kZXgoKSB7XG4gICAgaWYgKHRoaXMuaW5kZXggPT09IHRoaXMudGFibGVzLmxlbmd0aCAtIDEpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5pbmRleCArPSAxO1xuICB9XG5cbiAgKiBnZW5Db29yZHNJbk9yZGVyKGNvb3JkLCByZWZlcmVuY2UsIGNvbXBhcmVGdW5jID0gKCkgPT4gdHJ1ZSkge1xuICAgIGxldCBjdXJyZW50Q29vcmQgPSBjb29yZDtcbiAgICB3aGlsZSAoY29tcGFyZUZ1bmMoY3VycmVudENvb3JkLCByZWZlcmVuY2UpKSB7XG4gICAgICB5aWVsZCBjdXJyZW50Q29vcmQ7XG4gICAgICBjdXJyZW50Q29vcmQgPSB0aGlzLmdldE5leHRDb29yZChjdXJyZW50Q29vcmQpO1xuICAgIH1cbiAgfVxuXG4gIGdldENvb3Jkc0ZvcndhcmQoY29vcmQsIG4pIHtcbiAgICBpZiAobiA9PT0gMCkgeyByZXR1cm4gY29vcmQ7IH1cbiAgICByZXR1cm4gdGhpcy5nZXRDb29yZHNGb3J3YXJkKHRoaXMuZ2V0TmV4dENvb3JkKGNvb3JkKSwgLS1uKTtcbiAgfVxuXG4gIGdldENvb3Jkc0Fnbyhjb29yZCwgbikge1xuICAgIGlmIChuID09PSAwKSB7IHJldHVybiBjb29yZDsgfVxuICAgIHJldHVybiB0aGlzLmdldENvb3Jkc0Fnbyh0aGlzLmdldFByZXZDb29yZChjb29yZCksIC0tbik7XG4gIH1cblxuICBnZXROZXh0Q29vcmQoY29vcmQpIHtcbiAgICByZXR1cm4gY29vcmRbMl0gPCB0aGlzLmxhc3RDZWxsSW5kZXggXG4gICAgICA/IFtjb29yZFswXSwgY29vcmRbMV0sIGNvb3JkWzJdICsgMV0gXG4gICAgICA6IHRoaXMuZ2V0Q2VsbChbY29vcmRbMF0sIGNvb3JkWzFdICsgMSwgMF0pIFxuICAgICAgICA/IFtjb29yZFswXSwgY29vcmRbMV0gKyAxLCAwXSBcbiAgICAgICAgOiBbY29vcmRbMF0gKyAxLCAwLCAwXTtcbiAgfVxuXG4gIGdldFByZXZDb29yZChjb29yZCkge1xuICAgIHJldHVybiBjb29yZFsyXSA+IDAgXG4gICAgICA/IFtjb29yZFswXSwgY29vcmRbMV0sIGNvb3JkWzJdIC0gMV0gXG4gICAgICA6IGNvb3JkWzFdID4gMFxuICAgICAgICA/IFtjb29yZFswXSwgY29vcmRbMV0gLSAxLCB0aGlzLmxhc3RDZWxsSW5kZXhdXG4gICAgICAgIDogW1xuICAgICAgICAgIGNvb3JkWzBdIC0gMSxcbiAgICAgICAgICB0aGlzLmdldExhc3RSb3dJbmRleChjb29yZFswXSAtIDEpLFxuICAgICAgICAgIHRoaXMubGFzdENlbGxJbmRleFxuICAgICAgICBdO1xuICB9XG5cbiAgZ2V0TGFzdENlbGxDb29yZChpbmRleCkge1xuICAgIHJldHVybiBbaW5kZXgsIHRoaXMuZ2V0TGFzdFJvd0luZGV4KGluZGV4KSwgNl07XG4gIH1cblxuICBnZXRMYXN0Um93SW5kZXgoaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXROUm93cyhpbmRleCkgLSAxO1xuICB9XG5cbiAgZ2V0TlJvd3MoaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy50YWJsZXNbaW5kZXhdLnJvd3MubGVuZ3RoO1xuICB9XG5cbiAgZ2V0RWxlbUNvb3JkKGVsZW0pIHtcbiAgICByZXR1cm4gW1xuICAgICAgdGhpcy5pbmRleCwgXG4gICAgICBlbGVtLmNsb3Nlc3QoJ3RyJykucm93SW5kZXgsIFxuICAgICAgZWxlbS5jbG9zZXN0KCd0ZCcpLmNlbGxJbmRleFxuICAgIF07XG4gIH1cblxuICBnZXRDb29yZChpbmRleCwgbkNlbGxzKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIGluZGV4LFxuICAgICAgTWF0aC5mbG9vcigobkNlbGxzIC0gMSkgLyB0aGlzLnJvd1NpemUpLFxuICAgICAgKG5DZWxscyAtIDEpICUgdGhpcy5yb3dTaXplXG4gICAgXTtcbiAgfVxuXG4gIGdldENlbGwoY29vcmQpIHtcbiAgICByZXR1cm4gdGhpcy50YWJsZXNbY29vcmRbMF1dPy5yb3dzW2Nvb3JkWzFdXT8uY2VsbHNbY29vcmRbMl1dO1xuICB9XG5cbiAgc3RhdGljIGdldE1pbkNvb3JkKGNvb3JkQSwgY29vcmRCKSB7XG4gICAgcmV0dXJuIFRhYmxlcy5tYWtlVW5udW1lcmljYWwoXG4gICAgICBNYXRoLm1pbihUYWJsZXMubWFrZU51bWVyaWNhbChjb29yZEEpLCBUYWJsZXMubWFrZU51bWVyaWNhbChjb29yZEIpKVxuICAgICk7XG4gIH1cblxuICBzdGF0aWMgY29tcGFyZUNvb3JkKGNvb3JkQSwgY29vcmRCKSB7XG4gICAgcmV0dXJuIFRhYmxlcy5tYWtlTnVtZXJpY2FsKGNvb3JkQSkgLSBUYWJsZXMubWFrZU51bWVyaWNhbChjb29yZEIpO1xuICB9XG5cbiAgc3RhdGljIGlzQ29vcmRFcXVhbChjb29yZCwgcmVmZXJlbmNlKSB7XG4gICAgcmV0dXJuIFRhYmxlcy5tYWtlTnVtZXJpY2FsKGNvb3JkKSA9PT0gVGFibGVzLm1ha2VOdW1lcmljYWwocmVmZXJlbmNlKTtcbiAgfVxuXG4gIHN0YXRpYyBpc0Nvb3JkTW9yZShjb29yZCwgcmVmZXJlbmNlKSB7XG4gICAgcmV0dXJuIFRhYmxlcy5tYWtlTnVtZXJpY2FsKGNvb3JkKSA+IFRhYmxlcy5tYWtlTnVtZXJpY2FsKHJlZmVyZW5jZSk7XG4gIH1cblxuICBzdGF0aWMgaXNDb29yZExlc3MoY29vcmQsIHJlZmVyZW5jZSkge1xuICAgIHJldHVybiBUYWJsZXMubWFrZU51bWVyaWNhbChjb29yZCkgPCBUYWJsZXMubWFrZU51bWVyaWNhbChyZWZlcmVuY2UpO1xuICB9XG5cbiAgc3RhdGljIGlzQ29vcmRMZXNzT3JFcXVhbChjb29yZCwgcmVmZXJlbmNlKSB7XG4gICAgcmV0dXJuIFRhYmxlcy5tYWtlTnVtZXJpY2FsKGNvb3JkKSA8PSBUYWJsZXMubWFrZU51bWVyaWNhbChyZWZlcmVuY2UpO1xuICB9XG5cbiAgc3RhdGljIG1ha2VVbm51bWVyaWNhbChudW1lcmljYWxDb29yZCkge1xuICAgIHJldHVybiBUYWJsZXMuZmlsbENvb3JkKFN0cmluZyhudW1lcmljYWxDb29yZCkuc3BsaXQoJycpLm1hcChOdW1iZXIpKTtcbiAgfVxuXG4gIHN0YXRpYyBmaWxsQ29vcmQoY29vcmQsIGxlbmd0aCA9IGNvb3JkLmxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPj0gMykgeyByZXR1cm4gY29vcmQ7IH1cbiAgICByZXR1cm4gVGFibGVzLmZpbGxDb29yZChbMCwgLi4uY29vcmRdLCArK2xlbmd0aCk7XG4gIH1cblxuICBzdGF0aWMgbWFrZU51bWVyaWNhbChjb29yZCkge1xuICAgIHJldHVybiArY29vcmQucmVkdWNlKChyZXMsIGRpbWVuc2lvbikgPT4gcmVzICsgZGltZW5zaW9uLCAnJyk7XG4gIH1cblxuICBzdGF0aWMgZ2V0TGFzdEl0ZW0obGlzdCkge1xuICAgIHJldHVybiBsaXN0W2xpc3QubGVuZ3RoIC0gMV07XG4gIH1cbn1cblxuZXhwb3J0IHtUYWJsZXN9O1xuXG4iLCJpbXBvcnQge1RhYmxlc30gZnJvbSAnLi9UYWJsZXMuanMnO1xuXG5jbGFzcyBDYWwgZXh0ZW5kcyBUYWJsZXMge1xuICBjb25zdHJ1Y3Rvcihyb290KSB7XG4gICAgc3VwZXIocm9vdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdqcy1jYWxfX21haW4tdGFibGUnKSk7XG4gICAgdGhpcy5yb290ID0gcm9vdDtcbiAgICB0aGlzLm1vbnRoRm9ybWF0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgncnUnLCB7IG1vbnRoOiAnbG9uZycgfSk7XG4gICAgdGhpcy5yZWFkeURhdGVFdmVudCA9IG5ldyBDdXN0b21FdmVudChcbiAgICAgICdyZWFkeS1kYXRlJyxcbiAgICAgIHsgXG4gICAgICAgIGJ1YmJsZXM6IHRydWUsIFxuICAgICAgICBkZXRhaWw6ICdkYXRlIHJhbmdlIGlzIHJlYWR5IChzdGFydCBhbmQgZW5kIHJhbmdlIGRhdGEgZmlsbGVkKSdcbiAgICAgIH1cbiAgICApO1xuICAgIHRoaXMubmV4dE1vbnRoQnRuID0gdGhpcy5yb290LnF1ZXJ5U2VsZWN0b3IoJy5qcy1jYWxfX25leHQtbW9udGgtYnRuJyk7XG4gICAgdGhpcy5jYW5jbGVCdG4gPSB0aGlzLnJvb3QucXVlcnlTZWxlY3RvcignLmpzLWNhbF9fY2FuY2xlLWJ0bicpO1xuICAgIHRoaXMudGFibGVDb250YWluZXIgPSB0aGlzLnJvb3QucXVlcnlTZWxlY3RvcignLmpzLWNhbF9fdGFibGUtY29udGFpbmVyJyk7XG4gICAgdGhpcy5lcnJvciA9IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKCcuanMtY2FsX19lcnJvcicpO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gdGhpcy5lcnJvci5pbm5lclRleHQ7XG4gICAgdGhpcy5lcnJvci5pbm5lclRleHQgPSAnJztcbiAgICB0aGlzLnRlbXBsYXRlID0gdGhpcy50YWJsZUNvbnRhaW5lci5pbm5lckhUTUw7XG4gICAgdGhpcy5tb250aERpc3BsYXkgPSB0aGlzLnJvb3QucXVlcnlTZWxlY3RvcignLmpzLWNhbF9fbW9udGgnKTtcbiAgICB0aGlzLnllYXJEaXNwbGF5ID0gdGhpcy5yb290LnF1ZXJ5U2VsZWN0b3IoJy5qcy1jYWxfX3llYXInKTtcbiAgICB0aGlzLnN0ZXAgPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKHRoaXMudGFibGVDb250YWluZXIpLndpZHRoKTtcbiAgICB0aGlzLnJhbmdlQ291bnRlciA9IDA7XG4gICAgdGhpcy5yYW5nZSA9IFtdO1xuICAgIHRoaXMuc3RhcnRSYW5nZSA9IFtdO1xuICAgIHRoaXMuZW5kUmFuZ2UgPSBbXTtcbiAgICB0aGlzLnNlbGVjdGVkTW9kID0gJ2NhbF9fZGF5X3NlbGVjdGVkJztcbiAgICB0aGlzLnN0YXJ0UmFuZ2VNb2QgPSAnY2FsX19kYXlfc3RhcnQtcmFuZ2UnO1xuICAgIHRoaXMuZW5kUmFuZ2VNb2QgPSAnY2FsX19kYXlfZW5kLXJhbmdlJztcbiAgICB0aGlzLnNlbGVjdGVkQnRuTW9kID0gJ2NhbF9fZGF5LWJ0bl9zZWxlY3RlZCc7XG4gICAgdGhpcy5uZXh0TW9udGhCdG5Nb2QgPSAnY2FsX19kYXktYnRuX25leHQtbW9udGgnO1xuICAgIHRoaXMucHJldk1vbnRoQnRuTW9kID0gJ2NhbF9fZGF5LWJ0bl9wcmV2LW1vbnRoJztcbiAgICB0aGlzLnRvZGF5QnRuTW9kID0gJ2NhbF9fZGF5LWJ0bl90b2RheXMnO1xuICAgIHRoaXMuaGFzaCA9IHRoaXMucm9vdC5kYXRhc2V0Lmhhc2ggfHwgJ2NhbDAnO1xuICAgIHRoaXMuaW5pdERhdGVzID0gdGhpcy5nZXRJbml0RGF0ZXMoKTtcbiAgICB0aGlzLnJvb3QuZGF0YXNldC5kYXRlID0gdGhpcy5pbml0RGF0ZXMuZGF0ZSB8fCAnJztcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSh0aGlzLmluaXREYXRlcy5kYXRlIHx8IERhdGUoKSk7XG4gICAgdGhpcy55ZWFyID0gbm93LmdldEZ1bGxZZWFyKCk7XG4gICAgdGhpcy5tb250aCA9IG5vdy5nZXRNb250aCgpO1xuICAgIHRoaXMuaW5pdChub3cpO1xuICB9XG5cbiAgZ2V0SW5pdERhdGVzKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLnJvb3QuZGF0YXNldDtcbiAgICBjb25zdCBzb3VyY2UgPSBkYXRhLmRhdGUgfHwgZGF0YS5zdGFydERhdGUgXG4gICAgICA/IGRhdGEgXG4gICAgICA6IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmhhc2gpKTtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0ZTogc291cmNlPy5kYXRlLFxuICAgICAgc3RhcnREYXRlOiBzb3VyY2U/LnN0YXJ0RGF0ZSxcbiAgICAgIGVuZERhdGU6IHNvdXJjZT8uZW5kRGF0ZVxuICAgIH07XG4gIH1cblxuICBpbml0KG5vdykge1xuICAgIHRoaXMubW9kaWZ5VG9kYXlzQnRuKG5vdyk7XG4gICAgdGhpcy5kaXNhYmxlQnRzbihub3cpO1xuICAgIHRoaXMuZmlsbFRhYmxlKHRoaXMuaW5kZXgpO1xuICAgIHRoaXMuY2xlYXJUYWJsZSh0aGlzLmluZGV4KTtcbiAgICB0aGlzLmJpbmRMaXN0ZW5lck9uTGFzdEJ0bih0aGlzLmluZGV4KTtcbiAgICB0aGlzLmluc2VydEZpbGxDbGVhclRhYmxlKHRoaXMuaW5kZXggKyAxKTtcbiAgICB0aGlzLnVwZGF0ZU1vbnRoRGlzcGxheVZhbHVlKCk7XG4gICAgdGhpcy51cGRhdGVZZWFyRGlzcGxheVZhbHVlKCk7XG4gICAgdGhpcy5iaW5kTGlzdGVuZXJzKCk7XG4gICAgaWYgKENhbC5jaGVja0RhdGVJc1ZhbGlkKHRoaXMuaW5pdERhdGVzLnN0YXJ0RGF0ZSkpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5zZXRJbml0aWFsUmFuZ2UodGhpcy5pbml0RGF0ZXMuc3RhcnREYXRlKTtcbiAgICBpZiAoQ2FsLmNoZWNrRGF0ZUlzVmFsaWQodGhpcy5pbml0RGF0ZXMuZW5kRGF0ZSkpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5zZXRJbml0aWFsUmFuZ2UodGhpcy5pbml0RGF0ZXMuZW5kRGF0ZSk7XG4gIH1cblxuICBtb2RpZnlUb2RheXNCdG4obm93KSB7XG4gICAgdGhpcy5nZXRCdXR0b24oXG4gICAgICB0aGlzLmdldENvb3JkKCAwLCB0aGlzLmdldFByZXZNb250aE5EYXkoMCkgKyBub3cuZ2V0RGF0ZSgpKVxuICAgIClcbiAgICAgIC5jbGFzc0xpc3QuYWRkKHRoaXMudG9kYXlCdG5Nb2QpO1xuICB9XG5cbiAgZGlzYWJsZUJ0c24obm93KSB7XG4gICAgWy4uLnRoaXMuZ2VuQ29vcmRzSW5PcmRlcihcbiAgICAgIFswLCAwLCAwXSxcbiAgICAgIHRoaXMuZ2V0Q29vcmQoIDAsIHRoaXMuZ2V0UHJldk1vbnRoTkRheSgwKSArIG5vdy5nZXREYXRlKCkpLFxuICAgICAgVGFibGVzLmlzQ29vcmRMZXNzLFxuICAgICldXG4gICAgICAuZm9yRWFjaCgoY29vcmQpID0+IChcbiAgICAgICAgdGhpcy5nZXRCdXR0b24oY29vcmQpLmRpc2FibGVkID0gdHJ1ZVxuICAgICAgKSk7XG4gIH1cblxuICBzZXRJbml0aWFsUmFuZ2UoZGF0ZVN0cikge1xuICAgIGNvbnN0IGJ0bkRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyKTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZ2V0SW5kZXgoYnRuRGF0ZSk7XG4gICAgdGhpcy5pbnNlcnRGaWxsQ2xlYXJUYWJsZU50aFRpbWVzKGluZGV4KTtcbiAgICBjb25zdCBjb29yZCA9IHRoaXMuZ2V0Q29vcmQoXG4gICAgICBpbmRleCwgXG4gICAgICB0aGlzLmdldFByZXZNb250aE5EYXkoaW5kZXgpICsgYnRuRGF0ZS5nZXREYXRlKClcbiAgICApO1xuICAgIGNvbnN0IGJ0biA9IHRoaXMuZ2V0QnV0dG9uKGNvb3JkKTtcbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgYnRuLmNsaWNrKCk7XG4gICAgdGhpcy5pbmRleCA9IDA7XG4gIH1cblxuICBnZXRJbmRleChyYW5nZURhdGUpIHtcbiAgICByZXR1cm4gKHJhbmdlRGF0ZS5nZXRGdWxsWWVhcigpIC0gdGhpcy55ZWFyKSAqIDEyIFxuICAgICAgLSB0aGlzLm1vbnRoICsgcmFuZ2VEYXRlLmdldE1vbnRoKCk7XG4gIH1cblxuICBpbnNlcnRGaWxsQ2xlYXJUYWJsZU50aFRpbWVzKG4pIHtcbiAgICBpZiAoIW4pIHsgcmV0dXJuOyB9XG4gICAgd2hpbGUgKHRoaXMudGFibGVzLmxlbmd0aCAhPSBuICsgMikge1xuICAgICAgdGhpcy5pbnNlcnRGaWxsQ2xlYXJUYWJsZSh0aGlzLnRhYmxlcy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIGluc2VydEZpbGxDbGVhclRhYmxlKGluZGV4KSB7XG4gICAgdGhpcy5pbnNlcnRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuZmlsbFRhYmxlKGluZGV4KTtcbiAgICB0aGlzLmNsZWFyVGFibGUoaW5kZXgpO1xuICAgIHRoaXMuYmluZExpc3RlbmVyT25MYXN0QnRuKGluZGV4KTtcbiAgICB0aGlzLmJpbmRMaXN0ZW5lck9uRmlyc3RCdG4oaW5kZXgpO1xuICB9XG5cbiAgdXBkYXRlTW9udGhEaXNwbGF5VmFsdWUoKSB7XG4gICAgdGhpcy5tb250aERpc3BsYXkuaW5uZXJUZXh0ID0gdGhpcy5tb250aEZvcm1hdGVyXG4gICAgICAuZm9ybWF0KG5ldyBEYXRlKHRoaXMueWVhciwgdGhpcy5tb250aCArIHRoaXMuaW5kZXgpKVxuICAgICAgLnJlcGxhY2UoL14uLywgKHMpID0+IHMudG9VcHBlckNhc2UoKSk7XG4gIH1cblxuICB1cGRhdGVZZWFyRGlzcGxheVZhbHVlKCkge1xuICAgIHRoaXMueWVhckRpc3BsYXkuaW5uZXJUZXh0ID0gbmV3IERhdGUoXG4gICAgICB0aGlzLnllYXIsIHRoaXMubW9udGggKyB0aGlzLmluZGV4XG4gICAgKS5nZXRGdWxsWWVhcigpO1xuICB9XG5cbiAgYmluZExpc3RlbmVycygpIHtcbiAgICB0aGlzLnJvb3QucXVlcnlTZWxlY3RvcignLmpzLWNhbF9fcHJldi1tb250aC1idG4nKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVQcmV2TW9udGhCdG5DbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5leHRNb250aEJ0blxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVOZXh0TW9udGhCdG5DbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5leHRNb250aEJ0blxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZU5leHRNb250aEJ0bktleWRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jYW5jbGVCdG5cbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlQ2FuY2xlQnRuQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jYW5jbGVCdG5cbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVDYW5jbGVCdG5LZXlkb3duLmJpbmQodGhpcykpO1xuICAgIHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKCcuanMtY2FsX19hcHBseS1idG4nKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVBcHBseUJ0bkNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMudGFibGVDb250YWluZXJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlVGFibGVDb250YWluZXJDbGljay5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGJpbmRMaXN0ZW5lck9uTGFzdEJ0bihpbmRleCkge1xuICAgIHRoaXMuZ2V0QnV0dG9uKHRoaXMuZ2V0TGFzdENlbGxDb29yZChpbmRleCkpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlTGFzdERheUJ0bktleWRvd24uYmluZCh0aGlzKSk7XG4gIH1cblxuICBiaW5kTGlzdGVuZXJPbkZpcnN0QnRuKGluZGV4KSB7XG4gICAgdGhpcy5nZXRCdXR0b24oW2luZGV4LCAwLCAwXSlcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVGaXJzdERheUJ0bktleWRvd24uYmluZCh0aGlzKSk7XG4gIH1cblxuICBoYW5kbGVQcmV2TW9udGhCdG5DbGljaygpIHtcbiAgICBpZiAodGhpcy5pbmRleCA9PSAwKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZGVjcmVhc2VJbmRleCgpO1xuICAgIHRoaXMuY2hhbmdlRGlzcGxheWVkTW9udGgoKTtcbiAgICB0aGlzLnVwZGF0ZU1vbnRoRGlzcGxheVZhbHVlKCk7XG4gICAgdGhpcy51cGRhdGVZZWFyRGlzcGxheVZhbHVlKCk7XG4gIH1cblxuICBoYW5kbGVOZXh0TW9udGhCdG5DbGljaygpIHtcbiAgICB0aGlzLmluY3JlYXNlSW5kZXgoKTtcbiAgICB0aGlzLmNoYW5nZURpc3BsYXllZE1vbnRoKCk7XG4gICAgdGhpcy51cGRhdGVNb250aERpc3BsYXlWYWx1ZSgpO1xuICAgIHRoaXMudXBkYXRlWWVhckRpc3BsYXlWYWx1ZSgpO1xuICAgIGlmICh0aGlzLmluZGV4ID09PSB0aGlzLnRhYmxlcy5sZW5ndGggLSAxKSB7XG4gICAgICB0aGlzLmluc2VydEZpbGxDbGVhclRhYmxlKHRoaXMuaW5kZXggKyAxKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVDYW5jbGVCdG5DbGljaygpIHtcbiAgICB0aGlzLmNsZWFyUmFuZ2UoKTtcbiAgICB0aGlzLmNsZWFyUmFuZ2VEYXRhKCk7XG4gIH1cblxuICBoYW5kbGVBcHBseUJ0bkNsaWNrKCkge1xuICAgIHRoaXMuc2V0U2Vzc1N0b3JEYXRlKCk7XG4gICAgdGhpcy5lcnJvci5pbm5lclRleHQgPSB0aGlzLmVycm9yTWVzc2FnZTtcbiAgICBpZiAodGhpcy5pc0VuZFJhbmdlKCkpIHtcbiAgICAgIHRoaXMucm9vdC5kaXNwYXRjaEV2ZW50KHRoaXMucmVhZHlEYXRlRXZlbnQpO1xuICAgICAgdGhpcy5lcnJvci5pbm5lclRleHQgPSAnJztcbiAgICB9XG4gIH1cblxuICBzZXRTZXNzU3RvckRhdGUoKSB7XG4gICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcbiAgICAgIHRoaXMuaGFzaCwgXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGRhdGU6IHRoaXMucm9vdC5kYXRhc2V0LmRhdGUsXG4gICAgICAgIHN0YXJ0RGF0ZTogdGhpcy5yb290LmRhdGFzZXQuc3RhcnREYXRlLFxuICAgICAgICBlbmREYXRlOiB0aGlzLnJvb3QuZGF0YXNldC5lbmREYXRlXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBoYW5kbGVMYXN0RGF5QnRuS2V5ZG93bihlKSB7XG4gICAgaWYgKGUuY29kZSA9PT0gJ1RhYicgJiYgIWUuc2hpZnRLZXkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuY2FuY2xlQnRuLmZpcnN0RWxlbWVudENoaWxkLmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlRmlyc3REYXlCdG5LZXlkb3duKGUpIHtcbiAgICBpZiAoZS5jb2RlID09PSAnVGFiJyAmJiBlLnNoaWZ0S2V5KSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLm5leHRNb250aEJ0bi5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUNhbmNsZUJ0bktleWRvd24oZSkge1xuICAgIGlmIChlLmNvZGUgPT09ICdUYWInICYmIGUuc2hpZnRLZXkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuZ2V0QnV0dG9uKHRoaXMuZ2V0TGFzdENlbGxDb29yZCh0aGlzLmluZGV4KSkuZm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVOZXh0TW9udGhCdG5LZXlkb3duKGUpIHtcbiAgICBpZiAoZS5jb2RlID09PSAnVGFiJyAmJiAhZS5zaGlmdEtleSAmJiB0aGlzLmluZGV4ICE9PSAwKSB7IFxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5nZXRCdXR0b24oW3RoaXMuaW5kZXgsIDAsIDBdKS5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZVRhYmxlQ29udGFpbmVyQ2xpY2soZSkge1xuICAgIGNvbnN0IGJ0biA9IGUudGFyZ2V0O1xuICAgIGlmICghYnRuLmNsYXNzTGlzdC5jb250YWlucygnY2FsX19kYXktYnRuJykpIHsgcmV0dXJuOyB9XG4gICAgY29uc3QgaXNTZWxlY3RlZCA9IGJ0bi5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuc2VsZWN0ZWRCdG5Nb2QpO1xuICAgIGlmIChpc1NlbGVjdGVkID09PSBmYWxzZSkge1xuICAgICAgdGhpcy5jbGVhclJhbmdlKCk7XG4gICAgICB0aGlzLmNsZWFyUmFuZ2VEYXRhKCk7XG4gICAgICB0aGlzLnJlbW92ZURhdGFJc1JlYWR5KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLmlzRW5kUmFuZ2UoKSkgeyBcbiAgICAgIHRoaXMuY2xlYXJSYW5nZSgpOyBcbiAgICAgIHRoaXMuY2xlYXJSYW5nZURhdGEoKTtcbiAgICB9XG4gICAgdGhpcy5yYW5nZUNvdW50ZXIgKz0gMTtcbiAgICBjb25zdCBidG5Db29yZCA9IHRoaXMuZ2V0RWxlbUNvb3JkKGJ0bik7XG4gICAgY29uc3QgZmlyc3RSb3dCdG4gPSB0aGlzLmdldEJ1dHRvbihbYnRuQ29vcmRbMF0sIGJ0bkNvb3JkWzFdLCAwXSk7XG4gICAgY29uc3QgbGFzdFJvd0J0biA9IHRoaXMuZ2V0QnV0dG9uKFtidG5Db29yZFswXSwgYnRuQ29vcmRbMV0sIDZdKTtcbiAgICB0aGlzLmFkZENvb3JkSW5SYW5nZShidG5Db29yZCk7XG4gICAgY29uc3QgaXNQcmV2TW9udGhidG4gPSBidG4uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMucHJldk1vbnRoQnRuTW9kKTtcbiAgICBjb25zdCBpc05leHRNb250aEJ0biA9IGJ0bi5jbGFzc0xpc3QuY29udGFpbnModGhpcy5uZXh0TW9udGhCdG5Nb2QpO1xuICAgIGNvbnN0IHNob3VsZFNlbGVjdGVkUHJldk1vbnRoID0gZmlyc3RSb3dCdG5cbiAgICAgIC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5wcmV2TW9udGhCdG5Nb2QpO1xuICAgIGNvbnN0IHNob3VsZFNlbGVjdGVkTmV4dE1vbnRoID0gbGFzdFJvd0J0blxuICAgICAgLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLm5leHRNb250aEJ0bk1vZCk7XG4gICAgaWYgKGlzUHJldk1vbnRoYnRuIHx8IHNob3VsZFNlbGVjdGVkUHJldk1vbnRoKSB7XG4gICAgICB0aGlzLmFkZENvb3JkSW5SYW5nZSh0aGlzLmdldENvb3Jkc0FnbyhidG5Db29yZCwgNykpO1xuICAgIH1cbiAgICBpZiAoaXNOZXh0TW9udGhCdG4gfHwgc2hvdWxkU2VsZWN0ZWROZXh0TW9udGgpIHtcbiAgICAgIHRoaXMuYWRkQ29vcmRJblJhbmdlKHRoaXMuZ2V0Q29vcmRzRm9yd2FyZChidG5Db29yZCwgNykpO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdExhc3RSYW5nZUJ0bigpO1xuICAgIHRoaXMucmVtb3ZlRGF0YUlzUmVhZHkoKTtcbiAgICBpZiAodGhpcy5pc0VuZFJhbmdlKCkpIHtcbiAgICAgIHRoaXMub3JkZXJSYW5nZSgpO1xuICAgICAgdGhpcy5kcmF3UmFuZ2UodGhpcy5yYW5nZVswXSk7XG4gICAgICB0aGlzLmZpeE9yZGVyUmFuZ2UoKTtcbiAgICAgIHRoaXMubW9kaWZ5UmFuZ2VDZWxscygpO1xuICAgICAgdGhpcy5zZXREYXRhSXNSZWFkeSgpO1xuICAgIH1cbiAgICB0aGlzLnNldFJhbmdlRGF0YSgpO1xuICB9XG5cbiAgZHJhd1JhbmdlKGNvb3JkKSB7XG4gICAgY29uc3QgbmV4dENvb3JkID0gdGhpcy5zZWFyY2hOZXh0UmFuZ2VDb29yZChcbiAgICAgIHRoaXMuZHJhd1BhcnRPZlJhbmdlKFxuICAgICAgICB0aGlzLmdlbkNvb3Jkc0luT3JkZXIoXG4gICAgICAgICAgY29vcmQsXG4gICAgICAgICAgdGhpcy5zZWFyY2hOZXh0UmFuZ2VDb29yZChjb29yZCkgfHwgVGFibGVzLmdldExhc3RJdGVtKHRoaXMucmFuZ2UpLFxuICAgICAgICAgIChcbiAgICAgICAgICAgIHRoaXMuZ2V0QnV0dG9uKFtjb29yZFswXSwgY29vcmRbMV0sIDZdKVxuICAgICAgICAgICAgICAuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMubmV4dE1vbnRoQnRuTW9kKVxuICAgICAgICAgICAgICA/ICgobGFzdENvb3JkKSA9PiAoY29vcmQpID0+IChcbiAgICAgICAgICAgICAgICBUYWJsZXMuaXNDb29yZExlc3NPckVxdWFsKGNvb3JkLCBsYXN0Q29vcmQpXG4gICAgICAgICAgICAgICkpKFRhYmxlcy5nZXRNaW5Db29yZChcbiAgICAgICAgICAgICAgICB0aGlzLmdldExhc3RDZWxsQ29vcmQoY29vcmRbMF0pLFxuICAgICAgICAgICAgICAgIHRoaXMucmFuZ2VbMV1cbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgOiBUYWJsZXMuaXNDb29yZExlc3NPckVxdWFsXG4gICAgICAgICAgKSxcbiAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gICAgaWYgKG5leHRDb29yZCkgeyBcbiAgICAgIHRoaXMuZHJhd1JhbmdlKFxuICAgICAgICBUYWJsZXMuaXNDb29yZEVxdWFsKG5leHRDb29yZCwgVGFibGVzLmdldExhc3RJdGVtKHRoaXMucmFuZ2UpKSBcbiAgICAgICAgICA/IFtUYWJsZXMuZ2V0TGFzdEl0ZW0odGhpcy5yYW5nZSlbMF0sIDAsIDBdIFxuICAgICAgICAgIDogbmV4dENvb3JkXG4gICAgICApOyBcbiAgICB9XG4gIH1cblxuICBzZWFyY2hOZXh0UmFuZ2VDb29yZChjb29yZCkge1xuICAgIHJldHVybiB0aGlzLnJhbmdlLmZpbmQoKGMpID0+IFRhYmxlcy5pc0Nvb3JkTW9yZShjLCBjb29yZCkpO1xuICB9XG5cbiAgZHJhd1BhcnRPZlJhbmdlKGdlbmVyYXRvcikge1xuICAgIGNvbnN0IGNvb3JkcyA9IFsuLi5nZW5lcmF0b3JdO1xuICAgIGNvb3Jkcy5mb3JFYWNoKChjb29yZCkgPT4gKFxuICAgICAgdGhpcy5nZXRDZWxsKGNvb3JkKS5jbGFzc0xpc3QuYWRkKHRoaXMuc2VsZWN0ZWRNb2QpXG4gICAgKSk7XG4gICAgcmV0dXJuIFRhYmxlcy5nZXRMYXN0SXRlbShjb29yZHMpO1xuICB9XG5cbiAgZml4T3JkZXJSYW5nZSgpIHtcbiAgICB0aGlzLnN0YXJ0UmFuZ2Uuc29ydChUYWJsZXMuY29tcGFyZUNvb3JkKTtcbiAgICB0aGlzLmVuZFJhbmdlLnNvcnQoVGFibGVzLmNvbXBhcmVDb29yZCk7XG4gICAgY29uc3QgYnVmZmVyID0gdGhpcy5zdGFydFJhbmdlO1xuICAgIGlmIChUYWJsZXMuaXNDb29yZExlc3ModGhpcy5zdGFydFJhbmdlWzBdLCB0aGlzLmVuZFJhbmdlWzBdKSkgeyByZXR1cm47IH1cbiAgICB0aGlzLnN0YXJ0UmFuZ2UgPSB0aGlzLmVuZFJhbmdlO1xuICAgIHRoaXMuZW5kUmFuZ2UgPSBidWZmZXI7XG4gIH1cblxuICBtb2RpZnlSYW5nZUNlbGxzKCkge1xuICAgIHRoaXMuc3RhcnRSYW5nZS5mb3JFYWNoKChjb29yZCkgPT4ge1xuICAgICAgY29uc3QgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjb29yZCk7XG4gICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZWxlY3RlZE1vZCk7XG4gICAgICBjZWxsLmNsYXNzTGlzdC5hZGQodGhpcy5zdGFydFJhbmdlTW9kKTtcbiAgICB9KTtcbiAgICB0aGlzLmVuZFJhbmdlLmZvckVhY2goKGNvb3JkKSA9PiB7XG4gICAgICBjb25zdCBjZWxsID0gdGhpcy5nZXRDZWxsKGNvb3JkKTtcbiAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnNlbGVjdGVkTW9kKTtcbiAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCh0aGlzLmVuZFJhbmdlTW9kKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsZWFyUmFuZ2UoKSB7XG4gICAgaWYgKHRoaXMucmFuZ2VDb3VudGVyID09PSAyKSB7XG4gICAgICBbLi4udGhpcy5nZW5Db29yZHNJbk9yZGVyKFxuICAgICAgICB0aGlzLnJhbmdlWzBdLCBcbiAgICAgICAgVGFibGVzLmdldExhc3RJdGVtKHRoaXMucmFuZ2UpLFxuICAgICAgICBUYWJsZXMuaXNDb29yZExlc3NPckVxdWFsLFxuICAgICAgKV1cbiAgICAgICAgLmZvckVhY2goKGNvb3JkKSA9PiAoXG4gICAgICAgICAgdGhpcy5nZXRDZWxsKGNvb3JkKS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2VsZWN0ZWRNb2QpXG4gICAgICAgICkpO1xuICAgIH1cbiAgICBbLi4udGhpcy5zdGFydFJhbmdlLCAuLi50aGlzLmVuZFJhbmdlXS5mb3JFYWNoKChjb29yZCkgPT4ge1xuICAgICAgY29uc3QgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjb29yZCk7XG4gICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zdGFydFJhbmdlTW9kKTtcbiAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmVuZFJhbmdlTW9kKTtcbiAgICAgIHRoaXMuZ2V0QnV0dG9uKGNvb3JkKS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2VsZWN0ZWRCdG5Nb2QpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yYW5nZUNvdW50ZXIgPSAwO1xuICAgIHRoaXMucmFuZ2UgPSBbXTtcbiAgICB0aGlzLnN0YXJ0UmFuZ2UgPSBbXTtcbiAgICB0aGlzLmVuZFJhbmdlID0gW107XG4gIH1cblxuICBzZXRSYW5nZURhdGEoKSB7XG4gICAgdGhpcy5yb290LmRhdGFzZXQuc3RhcnREYXRlID0gKFxuICAgICAgQ2FsLmZvcm1hdERhdGUodGhpcy5nZXREYXRlRnJvbUNvb3JkKFxuICAgICAgICB0aGlzLnN0YXJ0UmFuZ2UuZmluZCh0aGlzLmlzUHJlc2VudERheUJ0bi5iaW5kKHRoaXMpKVxuICAgICAgKSlcbiAgICApO1xuICAgIGlmICh0aGlzLmVuZFJhbmdlLmxlbmd0aCAhPSAwKSB7XG4gICAgICB0aGlzLnJvb3QuZGF0YXNldC5lbmREYXRlID0gKFxuICAgICAgICBDYWwuZm9ybWF0RGF0ZSh0aGlzLmdldERhdGVGcm9tQ29vcmQoXG4gICAgICAgICAgdGhpcy5lbmRSYW5nZS5maW5kKHRoaXMuaXNQcmVzZW50RGF5QnRuLmJpbmQodGhpcykpXG4gICAgICAgICkpXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGNsZWFyUmFuZ2VEYXRhKCkge1xuICAgIHRoaXMucm9vdC5kYXRhc2V0LnN0YXJ0RGF0ZSA9ICcnO1xuICAgIHRoaXMucm9vdC5kYXRhc2V0LmVuZERhdGUgPSAnJztcbiAgfVxuXG4gIHNldERhdGFJc1JlYWR5KCkge1xuICAgIHRoaXMucm9vdC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGF0ZS1pcy1yZWFkeScsICcnKTtcbiAgfVxuXG4gIHJlbW92ZURhdGFJc1JlYWR5KCkge1xuICAgIHRoaXMucm9vdC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZGF0ZS1pcy1yZWFkeScpO1xuICB9XG5cbiAgaXNQcmVzZW50RGF5QnRuKGNvb3JkKSB7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5nZXRCdXR0b24oY29vcmQpO1xuICAgIGNvbnN0IGlzTmV4dCA9IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnModGhpcy5uZXh0TW9udGhCdG5Nb2QpO1xuICAgIGNvbnN0IGlzUHJldiA9IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnModGhpcy5wcmV2TW9udGhCdG5Nb2QpO1xuICAgIHJldHVybiAhKGlzTmV4dCB8fCBpc1ByZXYpO1xuICB9XG5cbiAgYWRkQ29vcmRJblJhbmdlKGNvb3JkKSB7XG4gICAgdGhpcy5nZXRMYXN0UmFuZ2UoKS5wdXNoKGNvb3JkKTtcbiAgfVxuXG4gIHNlbGVjdExhc3RSYW5nZUJ0bigpIHtcbiAgICB0aGlzLmdldEJ1dHRvbihUYWJsZXMuZ2V0TGFzdEl0ZW0odGhpcy5nZXRMYXN0UmFuZ2UoKSkpXG4gICAgICAuY2xhc3NMaXN0LmFkZCh0aGlzLnNlbGVjdGVkQnRuTW9kKTtcbiAgfVxuXG4gIGdldExhc3RSYW5nZSgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1N0YXJ0UmFuZ2UoKSA/IHRoaXMuc3RhcnRSYW5nZSA6IHRoaXMuZW5kUmFuZ2U7XG4gIH1cblxuICBpc1N0YXJ0UmFuZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMucmFuZ2VDb3VudGVyID09PSAxO1xuICB9XG5cbiAgaXNFbmRSYW5nZSgpIHtcbiAgICByZXR1cm4gdGhpcy5yYW5nZUNvdW50ZXIgPT09IDI7XG4gIH1cblxuICBvcmRlclJhbmdlKCkge1xuICAgIHRoaXMucmFuZ2UgPSBbLi4udGhpcy5zdGFydFJhbmdlLCAuLi50aGlzLmVuZFJhbmdlXVxuICAgICAgLnNvcnQoVGFibGVzLmNvbXBhcmVDb29yZCk7XG4gIH1cblxuICBjaGFuZ2VEaXNwbGF5ZWRNb250aCgpIHtcbiAgICB0aGlzLnRhYmxlc1swXS5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7LXRoaXMuaW5kZXggKiB0aGlzLnN0ZXB9cHhgO1xuICB9XG5cbiAgZmlsbFRhYmxlKGluZGV4KSB7XG4gICAgY29uc3QgZ2VuID0gdGhpcy5nZW5Db29yZHNJbk9yZGVyKFxuICAgICAgW2luZGV4LCAwLCAwXSwgXG4gICAgICBbaW5kZXgsIHRoaXMuZ2V0TGFzdFJvd0luZGV4KGluZGV4KSwgNl1cbiAgICApO1xuICAgIENhbC5nZXRQcmV2TW9udGhEYXkoXG4gICAgICBDYWwuZ2V0TW9udGhMYXN0RGF5KHRoaXMueWVhciwgdGhpcy5tb250aCArIGluZGV4IC0gMSksXG4gICAgICB0aGlzLmdldFByZXZNb250aE5EYXkoaW5kZXgpXG4gICAgKS5mb3JFYWNoKChkYXkpID0+IHtcbiAgICAgIGNvbnN0IGJ0biA9IHRoaXMuZ2V0QnV0dG9uKGdlbi5uZXh0KCkudmFsdWUpO1xuICAgICAgYnRuLmlubmVyVGV4dCA9IGRheTtcbiAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKHRoaXMucHJldk1vbnRoQnRuTW9kKTtcbiAgICB9KTtcbiAgICBDYWwuZ2V0UHJlc2VudERheSh0aGlzLmdldFByZXNlbnRORGF5KGluZGV4KSkuZm9yRWFjaCgoZGF5KSA9PiAoXG4gICAgICB0aGlzLmdldEJ1dHRvbihnZW4ubmV4dCgpLnZhbHVlKS5pbm5lclRleHQgPSBkYXlcbiAgICApKTtcbiAgICBDYWwuZ2V0TmV4dE1vbnRoRGF5KHRoaXMuZ2V0TmV4dE1vbnRoTkRheShpbmRleCkpLmZvckVhY2goKGRheSkgPT4ge1xuICAgICAgY29uc3QgYnRuID0gdGhpcy5nZXRCdXR0b24oZ2VuLm5leHQoKS52YWx1ZSk7XG4gICAgICBidG4uaW5uZXJUZXh0ID0gZGF5O1xuICAgICAgYnRuLmNsYXNzTGlzdC5hZGQodGhpcy5uZXh0TW9udGhCdG5Nb2QpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xlYXJUYWJsZShpbmRleCkge1xuICAgIGNvbnN0IG5GaWxsZWRSb3dzID0gTWF0aC5jZWlsKFxuICAgICAgKHRoaXMuZ2V0UHJldk1vbnRoTkRheShpbmRleCkgKyB0aGlzLmdldFByZXNlbnRORGF5KGluZGV4KSkgLyA3XG4gICAgKTtcbiAgICBmb3IgKGxldCByb3cgPSA1OyByb3cgPj0gbkZpbGxlZFJvd3M7IHJvdy0tKSB7XG4gICAgICB0aGlzLnRhYmxlc1tpbmRleF0ucm93c1tyb3ddLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIGluc2VydFRlbXBsYXRlKCkge1xuICAgIHRoaXMudGFibGVDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCB0aGlzLnRlbXBsYXRlKTtcbiAgfVxuXG4gIGdldE5leHRNb250aE5EYXkoaW5kZXgpIHtcbiAgICByZXR1cm4gNyAtIENhbC5nZXRXZWVrRGF5KFxuICAgICAgdGhpcy55ZWFyLCBcbiAgICAgIHRoaXMubW9udGggKyBpbmRleCxcbiAgICAgIENhbC5nZXRNb250aExhc3REYXkodGhpcy55ZWFyLCB0aGlzLm1vbnRoICsgaW5kZXgpXG4gICAgKTtcbiAgfVxuXG4gIGdldFByZXNlbnRORGF5KGluZGV4KSB7XG4gICAgcmV0dXJuIENhbC5nZXRNb250aExhc3REYXkodGhpcy55ZWFyLCB0aGlzLm1vbnRoICsgaW5kZXgpO1xuICB9XG5cbiAgZ2V0UHJldk1vbnRoTkRheShpbmRleCkge1xuICAgIHJldHVybiBDYWwuZ2V0V2Vla0RheSh0aGlzLnllYXIsIHRoaXMubW9udGggKyBpbmRleCkgLSAxO1xuICB9XG5cbiAgZ2V0QnV0dG9uKGNvb3JkKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbChjb29yZCkuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gIH1cblxuICBnZXREYXRlRnJvbUNvb3JkKGNvb3JkKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKFxuICAgICAgdGhpcy55ZWFyLFxuICAgICAgdGhpcy5tb250aCArIGNvb3JkWzBdLCBcbiAgICAgIGNvb3JkWzFdICogNyArIGNvb3JkWzJdICsgMSAtIHRoaXMuZ2V0UHJldk1vbnRoTkRheShjb29yZFswXSlcbiAgICApO1xuICB9XG5cbiAgc3RhdGljIGNoZWNrRGF0ZUlzVmFsaWQoZGF0ZVN0cikge1xuICAgIHJldHVybiBuZXcgRGF0ZShkYXRlU3RyKS50b1N0cmluZygpID09PSAnSW52YWxpZCBEYXRlJztcbiAgfVxuXG4gIHN0YXRpYyBnZXROZXh0TW9udGhEYXkobmV4dE1vbnRoTkRheSkge1xuICAgIHJldHVybiBBcnJheShuZXh0TW9udGhORGF5KS5maWxsKDEpLm1hcCgoZCwgaWR4KSA9PiBkICsgaWR4KTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRQcmVzZW50RGF5KHByZXNlbnRNb250aE5EYXkpIHtcbiAgICByZXR1cm4gWy4uLkFycmF5KHByZXNlbnRNb250aE5EYXkpLmtleXMoKV0ubWFwKChkKSA9PiBkICsgMSk7XG4gIH1cblxuICBzdGF0aWMgZ2V0UHJldk1vbnRoRGF5KHByZXZMYXN0RGF0ZSwgcHJldk1vbnRoTkRheSkge1xuICAgIHJldHVybiBBcnJheShwcmV2TW9udGhORGF5KVxuICAgICAgLmZpbGwocHJldkxhc3REYXRlKVxuICAgICAgLm1hcCgoZCwgaWR4KSA9PiBkIC0gaWR4KVxuICAgICAgLnJldmVyc2UoKTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRXZWVrRGF5KHllYXIsIG1vbnRoLCBkYXkgPSAxKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpLmdldERheSgpIHx8IDc7XG4gIH1cblxuICBzdGF0aWMgZ2V0TW9udGhMYXN0RGF5KHllYXIsIG1vbnRoKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoICsgMSwgMCkuZ2V0RGF0ZSgpO1xuICB9XG5cbiAgc3RhdGljIGZvcm1hdERhdGUoZGF0ZSkge1xuICAgIHJldHVybiBgJHtkYXRlLmdldEZ1bGxZZWFyKCl9LSR7ZGF0ZS5nZXRNb250aCgpICsgMX0tJHtkYXRlLmdldERhdGUoKX1gO1xuICB9XG59XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1jYWwnKS5mb3JFYWNoKChjYWwpID0+IG5ldyBDYWwoY2FsKSk7XG5cbiIsImNsYXNzIENoZWNrTGlzdCB7XG4gIGNvbnN0cnVjdG9yKHJvb3QpIHtcbiAgICB0aGlzLnJvb3QgPSByb290O1xuICAgIHRoaXMuYnV0dG9uID0gdGhpcy5yb290LnF1ZXJ5U2VsZWN0b3IoJy5jaGVjay1saXN0X19idXR0b24nKTtcbiAgICB0aGlzLmJpbmRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGJpbmRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmhhbmRsZUJ1dHRvbkNsaWNrKCkpO1xuICB9XG5cbiAgaGFuZGxlQnV0dG9uQ2xpY2soKSB7XG4gICAgdGhpcy5yb290LmNsYXNzTGlzdC50b2dnbGUoJ2NoZWNrLWxpc3Rfb3BlbicpO1xuICB9XG59XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGVjay1saXN0JykuZm9yRWFjaCgoY2wpID0+IG5ldyBDaGVja0xpc3QoY2wpKTtcbiIsImNsYXNzIERhdGVEcm9wZG93biB7XG4gIGNvbnN0cnVjdG9yKHJvb3QpIHtcbiAgICB0aGlzLmRhdGVGb3JtYXRlciA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KCdydScpO1xuICAgIHRoaXMuY2FsV3JhcHBlciA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLWRhdGUtZHJvcGRvd25fX2NhbC13cmFwcGVyJyk7XG4gICAgdGhpcy5jYWwgPSB0aGlzLmNhbFdyYXBwZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgdGhpcy5zdGFydEJ0biA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLWRhdGUtZHJvcGRvd25fX3N0YXJ0LWJ0bicpO1xuICAgIHRoaXMuZW5kQnRuID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuanMtZGF0ZS1kcm9wZG93bl9fZW5kLWJ0bicpO1xuICAgIHRoaXMuc3RhcnRTaWduYXR1cmUgPSB0aGlzLnN0YXJ0QnRuXG4gICAgICAucXVlcnlTZWxlY3RvcignLmpzLWRhdGUtZHJvcGRvd25fX2RhdGUtc2lnbmF0dXJlJyk7XG4gICAgdGhpcy5lbmRTaWduYXR1cmUgPSB0aGlzLmVuZEJ0blxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5qcy1kYXRlLWRyb3Bkb3duX19kYXRlLXNpZ25hdHVyZScpO1xuICAgIHRoaXMubWFzayA9IHRoaXMuc3RhcnRTaWduYXR1cmUuaW5uZXJUZXh0O1xuICAgIHRoaXMuZW5kTWFzayA9IHRoaXMuZW5kU2lnbmF0dXJlLmlubmVyVGV4dDtcbiAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoXG4gICAgICB0aGlzLmhhbmRsZUNhbEF0dHJzQ2hhbmdlcy5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUodGhpcy5jYWwsIHthdHRyaWJ1dGVzOiB0cnVlfSk7XG4gICAgdGhpcy5iaW5kTGlzdGVuZXJzKCk7XG4gICAgdGhpcy5oYW5kbGVDYWxBdHRyc0NoYW5nZXMoKTtcbiAgfVxuXG4gIGhhbmRsZUNhbEF0dHJzQ2hhbmdlcygpIHtcbiAgICB0aGlzLmhhbmRsZUNhbFN0YXJ0QXR0cnNDaGFuZ2VzKCk7XG4gICAgdGhpcy5oYW5kbGVDYWxFbmRBdHRyc0NoYW5nZXMoKTtcbiAgfVxuXG4gIGhhbmRsZUNhbFN0YXJ0QXR0cnNDaGFuZ2VzKCkge1xuICAgIHRoaXMudXBkYXRlU3RhcnRTaWduYXR1cmUobmV3IERhdGUodGhpcy5nZXRTdGFydERhdGUoKSkpO1xuICB9XG5cbiAgaGFuZGxlQ2FsRW5kQXR0cnNDaGFuZ2VzKCkge1xuICAgIHRoaXMudXBkYXRlRW5kU2lnbmF0dXJlKG5ldyBEYXRlKHRoaXMuZ2V0RW5kRGF0ZSgpKSk7XG4gIH1cblxuICB1cGRhdGVTdGFydFNpZ25hdHVyZShkYXRlKSB7XG4gICAgdGhpcy5jaGVja0RhdGUoZGF0ZSkgXG4gICAgICA/IHRoaXMuY2hhbmdlU3RhcnREYXRlU2lnbmF0eXJlKHRoaXMubWFzaykgXG4gICAgICA6IHRoaXMuY2hhbmdlU3RhcnREYXRlU2lnbmF0eXJlKHRoaXMuZm9ybWF0ZURhdGUoZGF0ZSkpO1xuICB9XG5cbiAgdXBkYXRlRW5kU2lnbmF0dXJlKGRhdGUpIHtcbiAgICB0aGlzLmNoZWNrRGF0ZShkYXRlKSBcbiAgICAgID8gdGhpcy5jaGFuZ2VFbmREYXRlU2lnbmF0eXJlKHRoaXMuZW5kTWFzaykgXG4gICAgICA6IHRoaXMuY2hhbmdlRW5kRGF0ZVNpZ25hdHlyZSh0aGlzLmZvcm1hdGVEYXRlKGRhdGUpKTtcbiAgfVxuXG4gIGdldFN0YXJ0RGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWwuZGF0YXNldC5zdGFydERhdGU7XG4gIH1cblxuICBnZXRFbmREYXRlKCkge1xuICAgIHJldHVybiB0aGlzLmNhbC5kYXRhc2V0LmVuZERhdGU7XG4gIH1cblxuICBjaGVja0RhdGUoZGF0ZSkge1xuICAgIHJldHVybiBkYXRlLnRvU3RyaW5nKCkgPT09ICdJbnZhbGlkIERhdGUnO1xuICB9XG5cbiAgZm9ybWF0ZURhdGUoZGF0ZSkge1xuICAgIHJldHVybiB0aGlzLmRhdGVGb3JtYXRlci5mb3JtYXQoZGF0ZSk7XG4gIH1cblxuICBjaGFuZ2VTdGFydERhdGVTaWduYXR5cmUoZGF0ZVN0cikge1xuICAgIHRoaXMuc3RhcnRTaWduYXR1cmUuaW5uZXJUZXh0ID0gZGF0ZVN0cjtcbiAgfVxuXG4gIGNoYW5nZUVuZERhdGVTaWduYXR5cmUoZGF0ZVN0cikge1xuICAgIHRoaXMuZW5kU2lnbmF0dXJlLmlubmVyVGV4dCA9IGRhdGVTdHI7XG4gIH1cblxuICBiaW5kTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUJ0bkNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZW5kQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVCdG5DbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNhbFdyYXBwZXJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdyZWFkeS1kYXRlJywgdGhpcy5oYW5kbGVCdG5DbGljay5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGhhbmRsZUJ0bkNsaWNrKCkge1xuICAgIHRoaXMuY2FsV3JhcHBlci5jbGFzc0xpc3QudG9nZ2xlKCdkYXRlLWRyb3Bkb3duX19jYWwtd3JhcHBlcl9oaWRkZW4nKTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtZGF0ZS1kcm9wZG93bicpXG4gIC5mb3JFYWNoKChkZCkgPT4gbmV3IERhdGVEcm9wZG93bihkZCkpO1xuXG4iLCJpbXBvcnQgR2xvc3NhcnkgZnJvbSAnLi9nbG9zc2FyeS9HbG9zc2FyeS5qcyc7XG5pbXBvcnQgKiBhcyBnbG9zc2FyeXMgZnJvbSAnLi9nbG9zc2FyeS9nbG9zc2FyeXMuanMnO1xuXG5jbGFzcyBEcm9wZG93biB7XG4gIGNvbnN0cnVjdG9yKGRyb3Bkb3duLCBnbG9zc2FyeSA9IHt9KSB7XG4gICAgdGhpcy5nbG9zc2FyeSA9IG5ldyBHbG9zc2FyeShnbG9zc2FyeSk7XG4gICAgdGhpcy5kcm9wZG93biA9IGRyb3Bkb3duO1xuICAgIHRoaXMuZXhwYW5kQnV0dG9uID0gZHJvcGRvd24ucXVlcnlTZWxlY3RvcignLmpzLWRyb3Bkb3duX19leHBhbmQtYnV0dG9uJyk7XG4gICAgdGhpcy5zaWduYXR1cmUgPSBkcm9wZG93bi5xdWVyeVNlbGVjdG9yKCcuanMtZHJvcGRvd25fX3NpZ25hdHVyZScpO1xuICAgIHRoaXMuZGVmYXVsdFNpZ25hdHVyZSA9IHRoaXMuc2lnbmF0dXJlLmlubmVyVGV4dDtcbiAgICB0aGlzLmxpc3QgPSBkcm9wZG93bi5xdWVyeVNlbGVjdG9yKCcuanMtZHJvcGRvd25fX2xpc3QnKTtcbiAgICB0aGlzLmRlY3JlYXNlQnV0dG9ucyA9IGRyb3Bkb3duXG4gICAgICAucXVlcnlTZWxlY3RvckFsbCgnLmpzLWRyb3Bkb3duX19kZWNyZWFzZS1idXR0b24nKTtcbiAgICB0aGlzLmluY3JlYXNlQnV0dG9ucyA9IGRyb3Bkb3duXG4gICAgICAucXVlcnlTZWxlY3RvckFsbCgnLmpzLWRyb3Bkb3duX19pbmNyZWFzZS1idXR0b24nKTtcbiAgICB0aGlzLmNvdW50ZXJzID0gW1xuICAgICAgLi4uZHJvcGRvd24ucXVlcnlTZWxlY3RvckFsbCgnLmpzLWRyb3Bkb3duX19jb3VudGVyJylcbiAgICBdO1xuICAgIHRoaXMuc2VjdGlvbk5hbWVzID0gQXJyYXkuZnJvbShcbiAgICAgIGRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1kcm9wZG93bl9fc2VjdGlvbi1uYW1lJyksXG4gICAgICAoc2VjdGlvbikgPT4gc2VjdGlvbi5pbm5lclRleHRcbiAgICApO1xuICAgIHRoaXMuYXBwbHlCdXR0b24gPSBkcm9wZG93bi5xdWVyeVNlbGVjdG9yKCcuanMtZHJvcGRvd25fX2FwcGx5LWJ1dHRvbicpO1xuICAgIHRoaXMuY2FuY2VsQnV0dG9uID0gZHJvcGRvd24ucXVlcnlTZWxlY3RvcignLmpzLWRyb3Bkb3duX19jYW5jZWwtYnV0dG9uJyk7XG4gICAgdGhpcy5yb3cgPSAwO1xuICAgIHRoaXMudmFsdWUgPSAwO1xuICAgIHRoaXMuY291bnRlcnNTdW0gPSAwO1xuICAgIHRoaXMuc2lnbmF0dXJlSW50ZXJmYWNlcyA9IHRoaXMuZ2V0U2lnbmF0dXJlSW50ZXJmYWNlcygpO1xuICAgIHRoaXMuYmluZExpc3RlbmVycygpO1xuICAgIHRoaXMuaGFzaCA9IHRoaXMuZHJvcGRvd24uZGF0YXNldC5oYXNoO1xuICAgIHRoaXMuc2V0Q291bnRlclZhbHVlcyh0aGlzLmdldEluaXRWYWx1ZXMoKSk7XG4gICAgaWYgKHRoaXMuZHJvcGRvd24uaGFzQXR0cmlidXRlKCdkYXRhLW9wZW4nKSkge1xuICAgICAgdGhpcy5leHBhbmRCdXR0b24uY2xpY2soKTsgXG4gICAgfVxuICB9XG5cbiAgZ2V0U2lnbmF0dXJlSW50ZXJmYWNlcygpIHtcbiAgICByZXR1cm4gdGhpcy5nbG9zc2FyeS50ZXJtcy5yZWR1Y2UoKGludGVyZmFjZXMsIHRlcm0pID0+IHsgXG4gICAgICBjb25zdCBzcGxpdGVkVGVybSA9IHRlcm0uc3BsaXQoJysnKTtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIC4uLmludGVyZmFjZXMsIFxuICAgICAgICB7XG4gICAgICAgICAgZ2V0VmFsdWU6ICgpID0+IChcbiAgICAgICAgICAgIHNwbGl0ZWRUZXJtLnJlZHVjZSgoc3VtLCBzcGxpdGVkVGVybSkgPT4gKFxuICAgICAgICAgICAgICArdGhpcy5jb3VudGVyc1t0aGlzLnNlY3Rpb25OYW1lcy5pbmRleE9mKHNwbGl0ZWRUZXJtKV1cbiAgICAgICAgICAgICAgICAuaW5uZXJUZXh0XG4gICAgICAgICAgICAgICsgc3VtXG4gICAgICAgICAgICApLCAwKVxuICAgICAgICAgICksXG4gICAgICAgICAgZ2V0TmFtZTogKCkgPT4gKFxuICAgICAgICAgICAgdGhpcy5zZWN0aW9uTmFtZXMuZmluZCgobmFtZSkgPT4gbmFtZSA9PT0gc3BsaXRlZFRlcm1bMF0pXG4gICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICBdO1xuICAgIH0sIFtdKTtcbiAgfVxuXG4gIGdldEluaXRWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZHJvcGRvd24uZGF0YXNldC5jb3VudGVyVmFsdWVzIFxuICAgICAgfHwgc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmhhc2gpXG4gICAgICB8fCAnJztcbiAgfVxuXG4gIGJpbmRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5leHBhbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdjbGljaycsXG4gICAgICB0aGlzLmhhbmRsZUV4cGFuZEJ1dHRvbkNsaWNrLmJpbmQodGhpcylcbiAgICApO1xuICAgIHRoaXMuZGVjcmVhc2VCdXR0b25zLmZvckVhY2goKGIpID0+IChcbiAgICAgIGIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZURlY3JlYXNlQnV0dG9uQ2xpY2suYmluZCh0aGlzKSlcbiAgICApKTtcbiAgICB0aGlzLmluY3JlYXNlQnV0dG9ucy5mb3JFYWNoKChiKSA9PiAoXG4gICAgICBiLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVJbmNyZWFzZUJ1dHRvbkNsaWNrLmJpbmQodGhpcykpXG4gICAgKSk7XG4gICAgdGhpcy5hcHBseUJ1dHRvbiAmJiB0aGlzLmFwcGx5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnY2xpY2snLCBcbiAgICAgIHRoaXMuaGFuZGVBcHBseUJ1dHRvbkNsaWNrLmJpbmQodGhpcylcbiAgICApO1xuICAgIHRoaXMuY2FuY2VsQnV0dG9uICYmIHRoaXMuY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnY2xpY2snLFxuICAgICAgdGhpcy5oYW5kbGVDYW5jZWxCdXR0b25DbGljay5iaW5kKHRoaXMpXG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZUV4cGFuZEJ1dHRvbkNsaWNrKCkge1xuICAgIHRoaXMuZXhwYW5kQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2Ryb3Bkb3duX19leHBhbmQtYnV0dG9uX3ByZXNzZWQnKTtcbiAgICB0aGlzLmxpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnZHJvcGRvd25fX2xpc3RfaGlkZGVuJyk7XG4gIH1cblxuICBoYW5kbGVEZWNyZWFzZUJ1dHRvbkNsaWNrKGUpIHtcbiAgICB0aGlzLnVwZGF0ZShlLnRhcmdldCk7XG4gICAgaWYgKHRoaXMudmFsdWUgPT09IDApIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMudmFsdWUgPT09IDEpIHsgdGhpcy50b2dnbGVEZWNyZWFzZUJ1dHRvbk1vZCgpOyB9XG4gICAgdGhpcy5jaGFuZ2VDb3VudGVyVmFsdWUoLTEpO1xuICAgIHRoaXMudXBkYXRlU2lnbmF0dXJlKHRoaXMuc2lnbmF0dXJlSW50ZXJmYWNlcyk7XG4gICAgdGhpcy5jb3VudGVyc1N1bSAtPSAxO1xuICAgIGlmICh0aGlzLmNvdW50ZXJzU3VtID09PSAwKSB7XG4gICAgICB0aGlzLnRvZ2dsZUNhbmNlbEJ1dHRvbk1vZCgpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUluY3JlYXNlQnV0dG9uQ2xpY2soZSkge1xuICAgIHRoaXMudXBkYXRlKGUudGFyZ2V0KTtcbiAgICBpZiAodGhpcy52YWx1ZSA9PT0gMCkgeyB0aGlzLnRvZ2dsZURlY3JlYXNlQnV0dG9uTW9kKCk7IH1cbiAgICB0aGlzLmNoYW5nZUNvdW50ZXJWYWx1ZSgxKTtcbiAgICB0aGlzLnVwZGF0ZVNpZ25hdHVyZSh0aGlzLnNpZ25hdHVyZUludGVyZmFjZXMpO1xuICAgIHRoaXMuY291bnRlcnNTdW0gKz0gMTtcbiAgICBpZiAodGhpcy5jb3VudGVyc1N1bSA9PT0gMSkge1xuICAgICAgdGhpcy50b2dnbGVDYW5jZWxCdXR0b25Nb2QoKTtcbiAgICB9XG4gIH1cblxuICBoYW5kZUFwcGx5QnV0dG9uQ2xpY2soKSB7XG4gICAgdGhpcy5leHBhbmRCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZHJvcGRvd25fX2V4cGFuZC1idXR0b25fcHJlc3NlZCcpO1xuICAgIHRoaXMubGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdkcm9wZG93bl9fbGlzdF9oaWRkZW4nKTtcbiAgICB0aGlzLmhhc2ggJiYgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcbiAgICAgIHRoaXMuaGFzaCwgXG4gICAgICB0aGlzLmNvdW50ZXJzLnJlZHVjZSgocmVzLCBjKSA9PiBgJHtyZXN9ICR7Yy5pbm5lclRleHR9YCwgJycpXG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZUNhbmNlbEJ1dHRvbkNsaWNrKCkge1xuICAgIHRoaXMucmVzZXRDb3VudGVycygpO1xuICAgIHRoaXMuY291bnRlcnNTdW0gPSAwO1xuICAgIHRoaXMuc2lnbmF0dXJlLmlubmVyVGV4dCA9IHRoaXMuZGVmYXVsdFNpZ25hdHVyZTtcbiAgICB0aGlzLmFkZERlY3Jlc2VCdXR0b25zTW9kKCk7XG4gICAgdGhpcy50b2dnbGVDYW5jZWxCdXR0b25Nb2QoKTtcbiAgfVxuXG4gIHNldENvdW50ZXJWYWx1ZXModmFsdWVzKSB7XG4gICAgKHZhbHVlcy5tYXRjaCgvXFxkKy9nKSB8fCBbXSkuZm9yRWFjaCgodiwgaWR4KSA9PiAoXG4gICAgICB0aGlzLmNsaWNrT25CdXR0b25OdGhUaW1lcygrdiwgdGhpcy5pbmNyZWFzZUJ1dHRvbnNbaWR4XSlcbiAgICApKTtcbiAgfVxuXG4gIGNsaWNrT25CdXR0b25OdGhUaW1lcyhuLCBidXR0b24pIHtcbiAgICBpZiAobiA8PSAwKSB7IHJldHVybjsgfVxuICAgIGJ1dHRvbi5jbGljaygpO1xuICAgIHRoaXMuY2xpY2tPbkJ1dHRvbk50aFRpbWVzKC0tbiwgYnV0dG9uKTtcbiAgfVxuXG4gIGNoYW5nZUNvdW50ZXJWYWx1ZShkaWZmKSB7XG4gICAgcmV0dXJuIHRoaXMuY291bnRlcnNbdGhpcy5yb3ddLmlubmVyVGV4dCA9IHRoaXMudmFsdWUgKyBkaWZmO1xuICB9XG5cbiAgcmVzZXRDb3VudGVycygpIHtcbiAgICB0aGlzLmNvdW50ZXJzLmZvckVhY2goKGMpID0+IGMuaW5uZXJUZXh0ID0gMCk7XG4gIH1cblxuICB0b2dnbGVEZWNyZWFzZUJ1dHRvbk1vZCgpIHtcbiAgICB0aGlzLmRlY3JlYXNlQnV0dG9uc1t0aGlzLnJvd11cbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKCdkcm9wZG93bl9fZGVjcmVhc2UtYnV0dG9uX2Rpc2FibGVkJyk7XG4gIH1cblxuICBhZGREZWNyZXNlQnV0dG9uc01vZCgpIHtcbiAgICB0aGlzLmRlY3JlYXNlQnV0dG9ucy5mb3JFYWNoKChiKSA9PiAoXG4gICAgICBiLmNsYXNzTGlzdC5hZGQoJ2Ryb3Bkb3duX19kZWNyZWFzZS1idXR0b25fZGlzYWJsZWQnKVxuICAgICkpO1xuICB9XG5cbiAgdG9nZ2xlQ2FuY2VsQnV0dG9uTW9kKCkge1xuICAgIGlmICh0aGlzLmNhbmNlbEJ1dHRvbikge1xuICAgICAgdGhpcy5jYW5jZWxCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZHJvcGRvd25fX2NhbmNlbC1idXR0b25faGlkZGVuJyk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlU2lnbmF0dXJlKGludGVyZmFjZXMgPSB0aGlzLnNpZ25hdHVyZUludGVyZmFjZXMpIHtcbiAgICB0aGlzLnNpZ25hdHVyZS5pbm5lclRleHQgPSBpbnRlcmZhY2VzLnJlZHVjZSgocmVzLCBpKSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGkuZ2V0VmFsdWUoKTtcbiAgICAgIGlmICh2YWx1ZSA9PT0gMCkgeyByZXR1cm4gcmVzOyB9XG4gICAgICBjb25zdCBwYXJ0ID0gYCR7dmFsdWV9ICR7XG4gICAgICAgIHRoaXMuZ2xvc3NhcnkuZ2V0RGVmaW5pdGlvbihpLmdldE5hbWUoKSwgdmFsdWUpXG4gICAgICB9YDtcbiAgICAgIHJldHVybiByZXMgPT09ICcnID8gcGFydCA6IGAke3Jlc30sICR7cGFydH1gO1xuICAgIH0sICcnKSB8fCB0aGlzLmRlZmF1bHRTaWduYXR1cmU7XG4gIH1cblxuICBnZXRSb3coYnV0dG9uKSB7XG4gICAgcmV0dXJuIE1hdGgubWF4KFxuICAgICAgWy4uLnRoaXMuZGVjcmVhc2VCdXR0b25zXS5pbmRleE9mKGJ1dHRvbiksXG4gICAgICBbLi4udGhpcy5pbmNyZWFzZUJ1dHRvbnNdLmluZGV4T2YoYnV0dG9uKSxcbiAgICAgIDBcbiAgICApO1xuICB9XG5cbiAgdXBkYXRlKGJ1dHRvbikge1xuICAgIHRoaXMucm93ID0gdGhpcy5nZXRSb3coYnV0dG9uKTtcbiAgICB0aGlzLnZhbHVlID0gK3RoaXMuY291bnRlcnNbdGhpcy5yb3ddLmlubmVyVGV4dDtcbiAgfVxufVxuXG5jb25zdCBnZXRTcGxpdGVkRGF0YSA9IChkcm9wZG93bikgPT4gZHJvcGRvd24uZGF0YXNldC5nbG9zc2FyeS5zcGxpdCgnLCAnKTtcbmNvbnN0IGNvbXBhcmUgPSAoZGF0YSkgPT4gKGdsb3NzYXJ5KSA9PiB7IFxuICBjb25zdCB0ZXJtcyA9IE9iamVjdC5rZXlzKGdsb3NzYXJ5KTtcbiAgcmV0dXJuIGRhdGEuZmlsdGVyKChkKSA9PiB0ZXJtcy5pbmRleE9mKGQpID09IC0xKS5sZW5ndGggPT0gMDtcbn07XG5jb25zdCBpbml0RHJvcGRvd25zID0gKGRyb3Bkb3ducywgZ2xvc3NhcnlzKSA9PiAoXG4gIGRyb3Bkb3ducy5mb3JFYWNoKChkKSA9PiAoXG4gICAgbmV3IERyb3Bkb3duKGQsIGdsb3NzYXJ5cy5maW5kKChjb21wYXJlKGdldFNwbGl0ZWREYXRhKGQpKSkpKVxuICApKVxuKTtcblxuaW5pdERyb3Bkb3ducyhcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmpzLWRyb3Bkb3duJyksIFxuICBPYmplY3QudmFsdWVzKGdsb3NzYXJ5cylcbik7XG5cbiIsImNsYXNzIEdsb3NzYXJ5IHtcbiAgY29uc3RydWN0b3IoZ2xvc3NhcnkgPSB7fSkge1xuICAgIHRoaXMuZ2xvc3NhcnkgPSBnbG9zc2FyeTtcbiAgICB0aGlzLnRlcm1zID0gT2JqZWN0LmtleXMoZ2xvc3NhcnkpO1xuICB9XG5cbiAgc3RhdGljIGNoZWNrRm9ybTEoZGlnaXQpIHtcbiAgICByZXR1cm4gZGlnaXQgPT09IDE7XG4gIH1cblxuICBzdGF0aWMgY2hlY2tGb3JtMihkaWdpdCkge1xuICAgIHJldHVybiBkaWdpdCA+IDEgJiYgZGlnaXQgPCA1O1xuICB9XG5cbiAgc3RhdGljIGNoZWNrRm9ybTMoZGlnaXQsIG4pIHtcbiAgICByZXR1cm4gKGRpZ2l0ID09PSAwIHx8IGRpZ2l0ID4gNCkgfHwgKG4gPiA5ICYmIG4gPCAyMCk7XG4gIH1cblxuICBzdGF0aWMgY29tcGFyZShzZWFyY2hXb3JkLCB0ZXJtKSB7XG4gICAgcmV0dXJuIHRlcm0udHJpbSgpLnNwbGl0KCcrJykuZmluZCgodCkgPT4gdCA9PT0gc2VhcmNoV29yZCk7XG4gIH1cblxuICBkZWZpbmVTaGFwZShuKSB7XG4gICAgY29uc3QgbGFzdERpZ2l0ID0gK1N0cmluZyhuKS5zbGljZSgtMSk7XG4gICAgcmV0dXJuIFtcbiAgICAgIEdsb3NzYXJ5LmNoZWNrRm9ybTEobGFzdERpZ2l0KSxcbiAgICAgIEdsb3NzYXJ5LmNoZWNrRm9ybTIobGFzdERpZ2l0KSxcbiAgICAgIEdsb3NzYXJ5LmNoZWNrRm9ybTMobGFzdERpZ2l0LCArU3RyaW5nKG4pLnNsaWNlKC0yKSlcbiAgICBdLmxhc3RJbmRleE9mKHRydWUpO1xuICB9XG5cbiAgZmluZFRlcm0od29yZCkge1xuICAgIHJldHVybiB0aGlzLnRlcm1zLmZpbmQoR2xvc3NhcnkuY29tcGFyZS5iaW5kKG51bGwsIHdvcmQpKTtcbiAgfVxuXG4gIGdldERlZmluaXRpb24odGVzdFdvcmQsIG51bWVyYWwpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5nbG9zc2FyeVt0aGlzLmZpbmRUZXJtKHRlc3RXb3JkKV0gfHwgW11cbiAgICApW3RoaXMuZGVmaW5lU2hhcGUobnVtZXJhbCldIHx8IHRlc3RXb3JkO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEdsb3NzYXJ5O1xuXG4iLCJleHBvcnQgY29uc3QgZzEgPSB7XG4gINGB0L/QsNC70YzQvdC4OiBbJ9GB0L/QsNC70YzQvdGPJywgJ9GB0L/QsNC70YzQvdC4JywgJ9GB0L/QsNC70LXQvSddLFxuICDQutGA0L7QstCw0YLQuDogWyfQutGA0L7QstCw0YLRjCcsICfQutGA0L7QstCw0YLQuCcsICfQutGA0L7QstCw0YLQtdC5J10sXG4gICfQstCw0L3QvdGL0LUg0LrQvtC80L3QsNGC0YsnOiBbJ9Cy0LDQvdC90LDRjyDQutC+0LzQvdCw0YLQsCcsICfQstCw0L3QvdGL0LUg0LrQvtC80L3QsNGC0YsnLCAn0LLQsNC90L3Ri9GFINC60L7QvNC90LDRgiddLFxufTtcblxuZXhwb3J0IGNvbnN0IGcyID0ge1xuICAn0LLQt9GA0L7RgdC70YvQtSvQtNC10YLQuCc6IFsn0LPQvtGB0YLRjCcsICfQs9C+0YHRgtGPJywgJ9Cz0L7RgdGC0LXQuSddLFxuICAn0LzQu9Cw0LTQtdC90YbRiyc6IFsn0LzQu9Cw0LTQtdC90LXRhicsICfQvNC70LDQtNC10L3RhtCwJywgJ9C80LvQsNC00LXQvdGG0LXQsiddXG59O1xuXG4iLCJjbGFzcyBGaWx0ZXJEYXRlRHJvcGRvd24ge1xuICBjb25zdHJ1Y3Rvcihyb290KSB7XG4gICAgdGhpcy5jYWxXcmFwcGVyID0gcm9vdFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5qcy1maWx0ZXItZGF0ZS1kcm9wZG93bl9fY2FsLXdyYXBwZXInKTtcbiAgICB0aGlzLmNhbCA9IHRoaXMuY2FsV3JhcHBlci5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICB0aGlzLmJ0biA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLWZpbHRlci1kYXRlLWRyb3Bkb3duX19idG4nKTtcbiAgICB0aGlzLnNpZ24gPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5qcy1maWx0ZXItZGF0ZS1kcm9wZG93bl9fc2lnbicpO1xuICAgIHRoaXMuZGF0ZUZvcm1hdGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoXG4gICAgICAncnUnLCBcbiAgICAgIHtkYXk6ICdudW1lcmljJywgbW9udGg6ICdzaG9ydCd9XG4gICAgKTtcbiAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodGhpcy5oYW5kbGVDYWxBdHRyc0NoYW5nZXMuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKHRoaXMuY2FsLCB7YXR0cmlidXRlczogdHJ1ZX0pO1xuICAgIHRoaXMuYmluZExpc3RlbmVycygpO1xuICAgIHRoaXMuaGFuZGxlQ2FsQXR0cnNDaGFuZ2VzKCk7XG4gIH1cblxuICBoYW5kbGVDYWxBdHRyc0NoYW5nZXMoKSB7XG4gICAgaWYgKHRoaXMuY2FsLmhhc0F0dHJpYnV0ZSgnZGF0YS1kYXRlLWlzLXJlYWR5JykpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmNhbC5kYXRhc2V0O1xuICAgICAgaWYgKGRhdGEuc3RhcnREYXRlID09PSAnJykgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuc2lnbi5pbm5lclRleHQgPSBgJHt0aGlzLmZvcm1hdGVEYXRlKG5ldyBEYXRlKGRhdGEuc3RhcnREYXRlKSl9IC0gJHtcbiAgICAgICAgdGhpcy5mb3JtYXRlRGF0ZShuZXcgRGF0ZShkYXRhLmVuZERhdGUpKVxuICAgICAgfWA7XG4gICAgfVxuICB9XG5cbiAgYmluZExpc3RlbmVycygpIHtcbiAgICBjb25zdCBiaW5kZWRIYW5kbGVCdG5DbGljayA9IHRoaXMuaGFuZGxlQnRuQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLmJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGJpbmRlZEhhbmRsZUJ0bkNsaWNrKTtcbiAgICB0aGlzLmNhbFdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigncmVhZHktZGF0ZScsIGJpbmRlZEhhbmRsZUJ0bkNsaWNrKTtcbiAgfVxuXG4gIGhhbmRsZUJ0bkNsaWNrKCkge1xuICAgIHRoaXMuYnRuLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbHRlci1kYXRlLWRyb3Bkb3duX19idG5fcHJlc3NlZCcpO1xuICAgIHRoaXMuY2FsV3JhcHBlclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbHRlci1kYXRlLWRyb3Bkb3duX19jYWwtd3JhcHBlcl9oaWRkZW4nKTtcbiAgfVxuXG4gIGZvcm1hdGVEYXRlKGRhdGUpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRlRm9ybWF0ZXIuZm9ybWF0KGRhdGUpLnNsaWNlKDAsIC0xKTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtZmlsdGVyLWRhdGUtZHJvcGRvd24nKVxuICAuZm9yRWFjaCgoZmRkKSA9PiBuZXcgRmlsdGVyRGF0ZURyb3Bkb3duKGZkZCkpO1xuXG4iLCJjb25zdCB0ZW1wbGF0ZSA9IChcbiAgYDxzdmcgXG4gICAgY2xhc3M9XCJpbXByZXNzaW9uc19fY2lyY2xlXCIgXG4gICAgd2lkdGg9XCIxMjBcIlxuICAgIGhlaWdodD1cIjEyMFwiXG4gICAgdmlld0JveD1cIi0yIDAgMTI0IDEyMFwiPlxuICAgIDxkZWZzPlxuICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwiYW1hemluZ1wiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIwJVwiIHkyPVwiMTAwJVwiPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0eWxlPVwic3RvcC1jb2xvcjojRkZFMzlDO3N0b3Atb3BhY2l0eToxXCIgLz5cbiAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0eWxlPVwic3RvcC1jb2xvcjojRkZCQTlDO3N0b3Atb3BhY2l0eToxXCIgLz5cbiAgICAgIDwvbGluZWFyR3JhZGllbnQ+XG4gICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJjb29sXCIgeDE9XCIwJVwiIHkxPVwiMCVcIiB4Mj1cIjAlXCIgeTI9XCIxMDAlXCI+XG4gICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiM2RkNGOTc7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiM2NkQyRUE7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgPC9saW5lYXJHcmFkaWVudD5cbiAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cImJhZFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIwJVwiIHkyPVwiMTAwJVwiPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0eWxlPVwic3RvcC1jb2xvcjojQkM5Q0ZGO3N0b3Atb3BhY2l0eToxXCIgLz5cbiAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMTAwJVwiIHN0eWxlPVwic3RvcC1jb2xvcjojOEJBNEY5O3N0b3Atb3BhY2l0eToxXCIgLz5cbiAgICAgIDwvbGluZWFyR3JhZGllbnQ+XG4gICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJ2ZXJ5QmFkXCIgeDE9XCIwJVwiIHkxPVwiMCVcIiB4Mj1cIjAlXCIgeTI9XCIxMDAlXCI+XG4gICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiM5MDkwOTA7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiMzRDQ5NzU7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgPC9saW5lYXJHcmFkaWVudD5cbiAgICA8L2RlZnM+IFxuICA8L3N2Zz5gXG4pO1xuY29uc3QgZ2V0VGVtcGxhdGVFbGVtID0gKHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdGVtcC5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyYmVnaW4nLCB0ZW1wbGF0ZSk7XG4gIHJldHVybiB0ZW1wLmZpcnN0Q2hpbGQ7XG59O1xuY29uc3QgaW5zZXJ0QXJjID0gKHRlbXBsYXRlRWxlbSkgPT4gKGFyYykgPT4ge1xuICB0ZW1wbGF0ZUVsZW0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBhcmMpO1xuICByZXR1cm4gdGVtcGxhdGVFbGVtO1xufTtcbmNvbnN0IHBhcnNlRGF0YSA9IChyb290KSA9PiB7XG4gIGNvbnN0IHthbWF6aW5nID0gMCwgY29vbCA9IDAsIGJhZCA9IDAsIHZlcnlCYWQgPSAwfSA9IHJvb3QuZGF0YXNldDtcbiAgcmV0dXJuIFsrYW1hemluZywgK2Nvb2wsICtiYWQsICt2ZXJ5QmFkXTtcbn07XG5jb25zdCBnZXROR2FwcyA9IChyYXRpbmcpID0+IHJhdGluZy5maWx0ZXIoKHIpID0+IHIpLmxlbmd0aDtcbmNvbnN0IGdldEZ1bGxBbmdsZSA9IChnYXApID0+IChuR2FwcykgPT4gMzYwIC0gZ2FwICogbkdhcHM7XG5jb25zdCBnZXRUb3RhbE1hcmtzID0gKHJhdGluZykgPT4gcmF0aW5nLnJlZHVjZSgocywgcikgPT4gcyArIHIpO1xuY29uc3QgZ2V0QW5nbGVzID0gKHRvdGFsTWFya3MpID0+IChmdWxsQW5nbGUpID0+IChyYXRlKSA9PiAoXG4gIHJhdGUgLyB0b3RhbE1hcmtzICogZnVsbEFuZ2xlXG4pO1xuY29uc3QgZ2V0U3RhcnRBbmdsZSA9IChnYXApID0+IChfLCBpZHgsIGFuZ2xlcykgPT4gKFxuICBhbmdsZXMuc2xpY2UoMCwgaWR4KVxuICAgIC5maWx0ZXIoKGFuZ2xlKSA9PiBhbmdsZSlcbiAgICAucmVkdWNlKChhY2MsIGFuZ2xlKSA9PiBhY2MgKyBhbmdsZSArIGdhcCwgZ2FwIC8gMilcbik7XG5jb25zdCBnZXRDbGFzcyA9IChpZHgpID0+IChcbiAgezA6ICdhbWF6aW5nJywgMTogJ2Nvb2wnLCAyOiAnYmFkJywgMzogJ3ZlcnlCYWQnfVtpZHhdXG4pO1xuY29uc3QgZ2V0UG9pbnQgPSAocikgPT4gKGFuZ2xlKSA9PiB7XG4gIGNvbnN0IGFuZ2xlUmFkID0gKGFuZ2xlICsgOTApICogTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgeCA9IHIgKiBNYXRoLmNvcyhhbmdsZVJhZCkgKyByO1xuICBjb25zdCB5ID0gTWF0aC5hYnMociAqIE1hdGguc2luKGFuZ2xlUmFkKSAtIHIpO1xuICByZXR1cm4geCArICcgJyArIHk7XG59O1xuY29uc3QgZ2V0QXJjID0gKGdhcCkgPT4gKHIpID0+IChnZXRTdGFydEFuZ2xlKSA9PiAoZ2V0UG9pbnQpID0+IFxuICAoYW5nbGUsIGlkeCwgYW5nbGVzKSA9PiAoXG4gICAgYDxwYXRoIFxuICAgICAgY2xhc3M9JHtnZXRDbGFzcyhpZHgpfVxuICAgICAgZD1cIk0ke2dldFBvaW50KGdldFN0YXJ0QW5nbGUoYW5nbGUsIGlkeCwgYW5nbGVzKSl9IFxuICAgICAgICBBJHtyfSAke3J9IDAgJHthbmdsZSA+IDE4MCA/IDEgOiAwfVxuICAgICAgICAwICR7Z2V0UG9pbnQoXG4gICAgICAoZ2V0U3RhcnRBbmdsZShhbmdsZSwgaWR4ICsgMSwgYW5nbGVzKSB8fCAzNjAgKyBnYXAgLyAyKSAtIGdhcCwgclxuICAgICl9XCIgXG4gICAgICBmaWxsPVwibm9uZVwiXG4gICAgICBzdHJva2U9dXJsKCMke2dldENsYXNzKGlkeCl9KVxuICAgICAgc3Ryb2tlLXdpZHRoPVwiNFwiXG4gICAgIC8+YFxuICApO1xuY29uc3QgZ2V0Q2lyY2xlID0gKHIpID0+IChyYXRpbmcpID0+IChcbiAgYDxjaXJjbGUgY3g9JHtyfSBjeT0ke3J9IHI9JHtyfSBcbiAgc3Ryb2tlPXVybCgjJHtnZXRDbGFzcyhyYXRpbmcuZmluZEluZGV4KChyKSA9PiByKSl9KSBcbiAgc3Ryb2tlLXdpZHRoPVwiNFwiIGZpbGw9XCJub25lXCIvPmBcbik7XG5jb25zdCBpbnNlcnRTaWduID0gKHRvdGFsTWFya3MpID0+ICh0ZW1wbGF0ZUVsZW0pID0+IChcbiAgdGVtcGxhdGVFbGVtLmluc2VydEFkamFjZW50SFRNTChcbiAgICAnYmVmb3JlZW5kJywgXG4gICAgYDx0ZXh0IFxuICAgICAgY2xhc3M9XCJpbXByZXNzaW9uc19fcm9vbS1udW1iZXJcIiBcbiAgICAgIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgXG4gICAgICB4PVwiNjBcIiBcbiAgICAgIHk9XCI2NVwiIFxuICAgICAgZmlsbD1cInVybCgjYmFkKVwiPiR7dG90YWxNYXJrc31cbiAgICA8L3RleHQ+XG4gICAgPHRleHQgXG4gICAgICBjbGFzcz1cImltcHJlc3Npb25zX19yb29tLXZvdGVzXCIgXG4gICAgICB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIFxuICAgICAgeD1cIjYwXCIgXG4gICAgICB5PVwiODFcIiBcbiAgICAgIGZpbGw9XCJ1cmwoI2JhZClcIj7Qs9C+0LvQvtGB0L7QslxuICAgIDwvdGV4dD5gXG4gICksIHRlbXBsYXRlRWxlbVxuKTtcbmNvbnN0IG1haW4gPSAoZ2FwKSA9PiAocikgPT4gKHJvb3QpID0+IChyYXRpbmcpID0+ICh0b3RhbE1hcmtzKSA9PiAoIFxuICByb290Lmluc2VydEFkamFjZW50RWxlbWVudChcbiAgICAnYmVmb3JlZW5kJywgXG4gICAgaW5zZXJ0U2lnbiAodG90YWxNYXJrcykgKFxuICAgICAgcmF0aW5nLmZpbHRlcigoeCkgPT4geCkubGVuZ3RoID09IDFcbiAgICAgICAgPyBpbnNlcnRBcmMgKGdldFRlbXBsYXRlRWxlbSAodGVtcGxhdGUpKSAoZ2V0Q2lyY2xlIChyKSAocmF0aW5nKSlcbiAgICAgICAgOiByYXRpbmcubWFwKFxuICAgICAgICAgIGdldEFuZ2xlcyAodG90YWxNYXJrcykgKFxuICAgICAgICAgICAgZ2V0RnVsbEFuZ2xlIChnYXApIChnZXROR2FwcyAocmF0aW5nKSlcbiAgICAgICAgICApXG4gICAgICAgICkucmVkdWNlKCh0ZW1wbGF0ZSwgYSwgaWR4LCBhbmdsZXMpID0+IChcbiAgICAgICAgICBhID09IDAgPyB0ZW1wbGF0ZSA6IGluc2VydEFyYyAodGVtcGxhdGUpIChcbiAgICAgICAgICAgIGdldEFyYyAoZ2FwKSAocikgKGdldFN0YXJ0QW5nbGUgKGdhcCkpIChnZXRQb2ludCAocikpIChcbiAgICAgICAgICAgICAgYSwgaWR4LCBhbmdsZXNcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgICksIGdldFRlbXBsYXRlRWxlbSAodGVtcGxhdGUpKVxuICAgIClcbiAgKVxuKTtcbmNvbnN0IGJpbmQgPSAobWFpbikgPT4gKGEpID0+IChmbikgPT4ge1xuICBjb25zdCBuZXdBID0gZm4oYSk7XG4gIHJldHVybiBiaW5kKG1haW4obmV3QSkpIChuZXdBKTtcbn07XG5jb25zdCBpbml0ID0gKHJvb3QpID0+IChcbiAgYmluZCAobWFpbig0KSg2MCkocm9vdCkpIChyb290KSAocGFyc2VEYXRhKSAoZ2V0VG90YWxNYXJrcylcbik7XG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtaW1wcmVzc2lvbnNfX2NpcmNsZS1jb250YWluZXInKVxuICAuZm9yRWFjaCgoYykgPT4gaW5pdChjKSk7XG5cbiIsImNsYXNzIExpa2Uge1xuICBjb25zdHJ1Y3RvcihsaWtlKSB7XG4gICAgdGhpcy5saWtlID0gbGlrZTtcbiAgICB0aGlzLmNvdW50ZXIgPSB0aGlzLmxpa2UucXVlcnlTZWxlY3RvcignLmpzLWxpa2VfX2NvdW50ZXInKTtcbiAgICB0aGlzLmJ0biA9IHRoaXMubGlrZS5xdWVyeVNlbGVjdG9yKCcuanMtbGlrZV9fYnRuJyk7XG4gICAgdGhpcy5iaW5kTGlzdGVuZXJzKCk7XG4gIH1cblxuICBiaW5kTGlzdGVuZXJzKCkge1xuICAgIHRoaXMubGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlTGlrZUNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMuYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5oYW5kbGVCdG5Gb2N1cy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmJ0bi5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5oYW5kbGVCdG5CbHVyLmJpbmQodGhpcykpO1xuICB9XG5cbiAgaGFuZGxlTGlrZUNsaWNrKCkge1xuICAgIHRoaXMubGlrZS5jbGFzc0xpc3QudG9nZ2xlKCdsaWtlX3ByZXNzZWQnKSBcbiAgICAgID8gdGhpcy5jb3VudGVyLmlubmVyVGV4dCAtPSAtMVxuICAgICAgOiB0aGlzLmNvdW50ZXIuaW5uZXJUZXh0IC09IDE7XG4gICAgdGhpcy5oYW5kbGVCdG5Gb2N1cygpO1xuICB9XG5cbiAgaGFuZGxlQnRuRm9jdXMoKSB7XG4gICAgdGhpcy5oYW5kbGVCdG5CbHVyKCk7XG4gICAgdGhpcy5saWtlLmNsYXNzTGlzdC5jb250YWlucygnbGlrZV9wcmVzc2VkJykgXG4gICAgICA/IHRoaXMubGlrZS5jbGFzc0xpc3QuYWRkKCdsaWtlX2ZvY3VzZWQtcHJlc3NlZCcpIFxuICAgICAgOiB0aGlzLmxpa2UuY2xhc3NMaXN0LmFkZCgnbGlrZV9mb2N1c2VkJyk7XG4gIH1cblxuICBoYW5kbGVCdG5CbHVyKCkge1xuICAgIHRoaXMubGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdsaWtlX2ZvY3VzZWQtcHJlc3NlZCcpO1xuICAgIHRoaXMubGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdsaWtlX2ZvY3VzZWQnKTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtbGlrZScpLmZvckVhY2goKGwpID0+IG5ldyBMaWtlKGwpKTtcblxuIiwiY2xhc3MgUmFuZ2VMYWJsZSB7XG4gIGNvbnN0cnVjdG9yKHJvb3QpIHtcbiAgICB0aGlzLnNsaWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJvb3QuZGF0YXNldC5zbGlkZXJJZCk7XG4gICAgaWYgKCF0aGlzLnNsaWRlcikgeyByZXR1cm47IH1cbiAgICB0aGlzLnN0YXJ0ID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcucmFuZ2UtbGFiZWxfX3N0YXJ0Jyk7XG4gICAgdGhpcy5lbmQgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5yYW5nZS1sYWJlbF9fZW5kJyk7XG4gICAgdGhpcy5vYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKFxuICAgICAgdGhpcy5oYW5kbGVTbGlkZXJDaGFuZ2VBdHRycy5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUodGhpcy5zbGlkZXIsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcbiAgICB0aGlzLmZvcm1hdGVyID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KFxuICAgICAgcm9vdC5kYXRhc2V0LmZvcm1hdGVyTGFuZywgXG4gICAgICB7XG4gICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogUmFuZ2VMYWJsZS5jYWxjRGVjaW1hbFBsYWNlcygrcm9vdC5kYXRhc2V0LnN0ZXApLFxuICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDAsXG4gICAgICAgIC4uLnJvb3QuZGF0YXNldC5mb3JtYXRlck9wdCBcbiAgICAgICAgICA/IEpTT04ucGFyc2Uocm9vdC5kYXRhc2V0LmZvcm1hdGVyT3B0KSBcbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgICAgICAgY3VycmVuY3k6ICdSVUInLFxuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICAgIGNvbnN0IGRhdGEgPSByb290LmRhdGFzZXQ7XG4gICAgdGhpcy5tYXggPSArZGF0YS5tYXg7XG4gICAgdGhpcy5taW4gPSArZGF0YS5taW47XG4gICAgdGhpcy5zdGVwID0gK2RhdGEuc3RlcDtcbiAgICB0aGlzLmhhbmRsZVNsaWRlckNoYW5nZUF0dHJzKCk7XG4gIH1cblxuICBoYW5kbGVTbGlkZXJDaGFuZ2VBdHRycygpIHtcbiAgICB0aGlzLnVwZGF0ZVN0YXJ0VmFsdWUoXG4gICAgICB0aGlzLmZvcm1hdChcbiAgICAgICAgdGhpcy5jYWxjVmFsdWUodGhpcy5zbGlkZXIuZGF0YXNldC5ic3ApXG4gICAgICApXG4gICAgKTtcbiAgICB0aGlzLnVwZGF0ZUVuZFZhbHVlKFxuICAgICAgdGhpcy5mb3JtYXQoXG4gICAgICAgIHRoaXMuY2FsY1ZhbHVlKHRoaXMuc2xpZGVyLmRhdGFzZXQuYmVwKVxuICAgICAgKVxuICAgICk7XG4gIH1cblxuICB1cGRhdGVTdGFydFZhbHVlKHZhbHVlKSB7XG4gICAgdGhpcy5zdGFydC5pbm5lclRleHQgPSB2YWx1ZTtcbiAgfVxuXG4gIHVwZGF0ZUVuZFZhbHVlKHZhbHVlKSB7XG4gICAgdGhpcy5lbmQuaW5uZXJUZXh0ID0gdmFsdWU7XG4gIH1cblxuICBmb3JtYXQocHJlVmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtYXRlci5mb3JtYXQocHJlVmFsdWUpLnJlcGxhY2UoL1xccyg/IVxcZCkvLCAnJyk7XG4gIH1cblxuICBjYWxjVmFsdWUocG9zKSB7XG4gICAgcmV0dXJuIE1hdGgubWluKFxuICAgICAgdGhpcy5tYXgsXG4gICAgICBNYXRoLmZsb29yKHBvcyAqICh0aGlzLm1heCAtIHRoaXMubWluICsgdGhpcy5zdGVwKSAvIHRoaXMuc3RlcCkgXG4gICAgICAqIHRoaXMuc3RlcCArIHRoaXMubWluXG4gICAgKTtcbiAgfVxuXG4gIHN0YXRpYyBjYWxjRGVjaW1hbFBsYWNlcyhuKSB7XG4gICAgY29uc3Qgc24gPSBTdHJpbmcobik7XG4gICAgY29uc3QgcG9pbnRJbmRleCA9IHNuLmluZGV4T2YoJy4nKTtcbiAgICByZXR1cm4gcG9pbnRJbmRleCA9PT0gLTEgPyAwIDogc24uc2xpY2UocG9pbnRJbmRleCArIDEpLmxlbmd0aDtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmFuZ2UtbGFiZWwnKS5mb3JFYWNoKChybCkgPT4gbmV3IFJhbmdlTGFibGUocmwpKTtcblxuIiwiY29uc3QgaWZmID0gKHByZWRpY2F0ZSwgZm4pID0+ICguLi5hcmdzKSA9PiBwcmVkaWNhdGUoKSAmJiBmbiguLi5hcmdzKTtcbmNvbnN0IHBpcGUgPSAoLi4uZm5zKSA9PiBmbnMucmVkdWNlUmlnaHQoKGEsIGIpID0+ICguLi5hcmdzKSA9PiBhKGIoLi4uYXJncykpKTtcblxuY29uc3QgcmVzaXplQmFyID0gKGJhciwgc3RhdGUpID0+ICgpID0+IChcbiAgYmFyLnN0eWxlLndpZHRoID0gYCR7XG4gICAgKHN0YXRlLnBiKCkgKyBzdGF0ZS5nZXRSZWxCdygpIC8gMikgKiAxMDAgLyBzdGF0ZS5nZXRSYXRpbygpIFxuICB9JWBcbik7XG5cbmNvbnN0IGNhbGNQb3NpdGlvbiA9IChjb250YWluZXIsIHN0YXRlKSA9PiAoZSkgPT4ge1xuICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4gKGUueCAtIHJlY3QueCAtIHN0YXRlLmdldFNoaWZ0KCkgKyBzdGF0ZS5iKCkub2Zmc2V0KSAvIHJlY3Qud2lkdGg7XG59O1xuXG5jb25zdCBtb3ZlQnV0dG9uID0gKGJ0biwgc3RhdGUpID0+IChwcmVwb3NpdGlvbikgPT4ge1xuICBjb25zdCBwb3NpdGlvbiA9IE1hdGgubWluKFxuICAgIHN0YXRlLmIoKS5tYXgsIE1hdGgubWF4KHByZXBvc2l0aW9uLCBzdGF0ZS5iKCkubWluKVxuICApO1xuICBidG4uc3R5bGUubGVmdCA9IGAke3Bvc2l0aW9uICogMTAwfSVgO1xuICBzdGF0ZS5zZXRCKHBvc2l0aW9uKTtcbiAgcmV0dXJuIHBvc2l0aW9uO1xufTtcblxuY29uc3QgYmluZFBvaW50ZXIgPSAoZWxlbSwgaWQpID0+IGVsZW0uc2V0UG9pbnRlckNhcHR1cmUoaWQpO1xuXG5jb25zdCBoYW5kbGVQb2ludGVyRG93biA9IChzdGF0ZSkgPT4gKGUpID0+IHtcbiAgYmluZFBvaW50ZXIoZS50YXJnZXQsIGUucG9pbnRlcklkKTtcbiAgc3RhdGUuc2V0U2hpZnQoZS54IC0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkueCk7XG4gIHN0YXRlLnJldHJpZ2dlcigpO1xufTtcblxuY29uc3QgaGFuZGxlTG9zdFBvaW50ZXIgPSAoc3RhdGUpID0+ICgpID0+IHN0YXRlLnJldHJpZ2dlcigpO1xuXG5jb25zdCBuZXdTdGF0ZSA9IChidywgdHJhY2spID0+IHtcbiAgY29uc3QgcyA9IHtcbiAgICBpc1RyaWdlcmVkOiBmYWxzZSxcbiAgICBzaGlmdDogMCxcbiAgICBzdHJldGNoUmF0aW86IDEsXG4gICAgYnM6IHsgbWF4OiAxLCBtaW46IDAsIG9mZnNldDogYncgfSxcbiAgICBiZTogeyBtYXg6IDEsIG1pbjogMCwgb2Zmc2V0OiAwIH0sXG4gIH07XG4gIGNvbnN0IGdldFJlbEJ3ID0gKCkgPT4gYncgLyB0cmFjay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcbiAgY29uc3Qgc2V0U3RyZXRjaFJhdGlvID0gKHJlbEJ3KSA9PiAocy5zdHJldGNoUmF0aW8gPSAxICsgcmVsQncgKiAyKTtcbiAgY29uc3QgdHJhbnNmb3JtVHJhY2sgPSAocmF0aW8gPSBzLnN0cmV0Y2hSYXRpbykgPT4gKFxuICAgIHRyYWNrLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3JhdGlvfSlgXG4gICk7XG4gIHRyYW5zZm9ybVRyYWNrKDEpOyBcbiAgc2V0U3RyZXRjaFJhdGlvKGdldFJlbEJ3KCkpO1xuICB0cmFuc2Zvcm1UcmFjaygpO1xuICByZXR1cm4gKHR5cGUgPSAnYnMnKSA9PiB7XG4gICAgY29uc3QgZXh0ZW5kZWRCdXR0b25JID0ge1xuICAgICAgZ2V0VHJpZ2dlcigpIHsgcmV0dXJuIHMuaXNUcmlnZXJlZDsgfSxcbiAgICAgIGdldFNoaWZ0KCkgeyByZXR1cm4gcy5zaGlmdDsgfVxuICAgIH07XG4gICAgY29uc3QgZXh0ZW5kZWRQQkkgPSB7XG4gICAgICBnZXRSYXRpbygpIHsgcmV0dXJuIHMuc3RyZXRjaFJhdGlvOyB9LFxuICAgICAgZ2V0UmVsQncoKSB7IHJldHVybiBnZXRSZWxCdygpOyB9LFxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgIGJzOiB7XG4gICAgICAgIGIoKSB7IHJldHVybiBzLmJzOyB9LFxuICAgICAgICBzZXRCKHBvcykgeyBzLmJlLm1pbiA9IHBvczsgfSxcbiAgICAgICAgLi4uZXh0ZW5kZWRCdXR0b25JXG4gICAgICB9LFxuICAgICAgYmU6IHtcbiAgICAgICAgYigpIHsgcmV0dXJuIHMuYmU7IH0sXG4gICAgICAgIHNldEIocG9zKSB7IHMuYnMubWF4ID0gcG9zOyB9LFxuICAgICAgICAuLi5leHRlbmRlZEJ1dHRvbklcbiAgICAgIH0sXG4gICAgICBwYnM6IHtcbiAgICAgICAgcGIoKSB7IHJldHVybiBzLmJlLm1pbjsgfSxcbiAgICAgICAgLi4uZXh0ZW5kZWRQQklcbiAgICAgIH0sXG4gICAgICBwYmU6IHtcbiAgICAgICAgcGIoKSB7IHJldHVybiAxIC0gcy5icy5tYXg7IH0sXG4gICAgICAgIC4uLmV4dGVuZGVkUEJJXG4gICAgICB9LFxuICAgICAgdDoge1xuICAgICAgICByZXRyaWdnZXIoKSB7IHMuaXNUcmlnZXJlZCA9ICFzLmlzVHJpZ2VyZWQ7IH0sXG4gICAgICAgIHNldFNoaWZ0KHZhbHVlKSB7IHMuc2hpZnQgPSB2YWx1ZTsgfSxcbiAgICAgIH0sXG4gICAgfVt0eXBlXTtcbiAgfTtcbn07XG5cbmNvbnN0IGJpbmRMaXN0ZW5lcnMgPSAocm9vdCkgPT4ge1xuICBjb25zdCBjb250YWluZXIgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5qcy1yYW5nZS1zbGlkZXJfX2NvbnRhaW5lcicpO1xuICBjb25zdCB0cmFjayA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLXJhbmdlLXNsaWRlcl9fYm9keScpO1xuICBjb25zdCBicyA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLXJhbmdlLXNsaWRlcl9fYnV0dG9uX3N0YXJ0LXJhbmdlJyk7XG4gIGNvbnN0IGJlID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuanMtcmFuZ2Utc2xpZGVyX19idXR0b25fZW5kLXJhbmdlJyk7XG4gIGNvbnN0IHBicyA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLXJhbmdlLXNsaWRlcl9fcHJvZ3Jlc3MtYmFyX3N0YXJ0Jyk7XG4gIGNvbnN0IHBiZSA9IHJvb3QucXVlcnlTZWxlY3RvcignLmpzLXJhbmdlLXNsaWRlcl9fcHJvZ3Jlc3MtYmFyX2VuZCcpO1xuICBjb25zdCBzdGF0ZSA9IG5ld1N0YXRlKGJzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoLCB0cmFjayk7XG4gIGNvbnN0IHtic3AsIGJlcH0gPSByb290LmRhdGFzZXQ7XG4gIGNvbnN0IG1vdmVIYW5kbGVyUyA9IHBpcGUoXG4gICAgY2FsY1Bvc2l0aW9uKGNvbnRhaW5lciwgc3RhdGUoJ2JzJykpLFxuICAgIG1vdmVCdXR0b24oYnMsIHN0YXRlKCdicycpKSxcbiAgICAocG9zKSA9PiByb290LmRhdGFzZXQuYnNwID0gcG9zLFxuICAgIHJlc2l6ZUJhcihwYnMsIHN0YXRlKCdwYnMnKSlcbiAgKTtcbiAgY29uc3QgbW92ZUhhbmRsZXJFID0gcGlwZShcbiAgICBjYWxjUG9zaXRpb24oY29udGFpbmVyLCBzdGF0ZSgnYmUnKSksXG4gICAgbW92ZUJ1dHRvbihiZSwgc3RhdGUoJ2JlJykpLFxuICAgIChwb3MpID0+IHJvb3QuZGF0YXNldC5iZXAgPSBwb3MsXG4gICAgcmVzaXplQmFyKHBiZSwgc3RhdGUoJ3BiZScpKVxuICApO1xuICBwaXBlKG1vdmVCdXR0b24oYnMsIHN0YXRlKCdicycpKSwgcmVzaXplQmFyKHBicywgc3RhdGUoJ3BicycpKSkoYnNwKTtcbiAgcGlwZShtb3ZlQnV0dG9uKGJlLCBzdGF0ZSgnYmUnKSksIHJlc2l6ZUJhcihwYmUsIHN0YXRlKCdwYmUnKSkpKGJlcCk7XG4gIFticywgYmVdLmZvckVhY2goKGIpID0+IHtcbiAgICBiLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgaGFuZGxlUG9pbnRlckRvd24oc3RhdGUoJ3QnKSkpO1xuICAgIGIuYWRkRXZlbnRMaXN0ZW5lcignbG9zdHBvaW50ZXJjYXB0dXJlJywgaGFuZGxlTG9zdFBvaW50ZXIoc3RhdGUoJ3QnKSkpO1xuICB9KTtcbiAgYnMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBpZmYoc3RhdGUoKS5nZXRUcmlnZ2VyLCBtb3ZlSGFuZGxlclMpKTtcbiAgYmUuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBpZmYoc3RhdGUoKS5nZXRUcmlnZ2VyLCBtb3ZlSGFuZGxlckUpKTtcbn07XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1yYW5nZS1zbGlkZXInKVxuICAuZm9yRWFjaCgocm9vdCkgPT4gYmluZExpc3RlbmVycyhyb290KSk7XG5cbiIsImNsYXNzIFN1YnNjcmlwdGlvblRleHRGaWVsZCB7XG4gIGNvbnN0cnVjdG9yKGVsZW0pIHtcbiAgICB0aGlzLnRleHRGaWVsZCA9IGVsZW07XG4gICAgdGhpcy5pbnB1dCA9IHRoaXMudGV4dEZpZWxkXG4gICAgICAucXVlcnlTZWxlY3RvcignLmpzLXN1YnNjcmlwdGlvbi10ZXh0LWZpZWxkX19pbnB1dCcpO1xuICAgIHRoaXMuYnV0dG9uID0gdGhpcy50ZXh0RmllbGRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuanMtc3Vic2NyaXB0aW9uLXRleHQtZmllbGRfX2J1dHRvbicpO1xuICAgIHRoaXMuYmluZExpc3RlbmVycygpO1xuICB9XG5cbiAgYmluZExpc3RlbmVycygpIHtcbiAgICB0aGlzLmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnZm9jdXMnLCBcbiAgICAgIHRoaXMuaGFuZGxlU3Vic2NyaXB0aW9uVGV4dEZpZWxkSW5wdXRGb2N1cy5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnYmx1cicsXG4gICAgICB0aGlzLmhhbmRsZVN1YnNjcmlwdGlvblRleHRGaWVsZElucHV0Qmx1ci5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ2ZvY3VzJyxcbiAgICAgIHRoaXMuaGFuZGxlU3Vic2NyaXB0aW9uVGV4dEZpZWxkSW5wdXRGb2N1cy5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ2JsdXInLFxuICAgICAgdGhpcy5oYW5kbGVTdWJzY3JpcHRpb25UZXh0RmllbGRJbnB1dEJsdXIuYmluZCh0aGlzKVxuICAgICk7XG4gIH1cblxuICBoYW5kbGVTdWJzY3JpcHRpb25UZXh0RmllbGRJbnB1dEZvY3VzKCkge1xuICAgIHRoaXMudGV4dEZpZWxkLmNsYXNzTGlzdC5hZGQoJ3N1YnNjcmlwdGlvbi10ZXh0LWZpZWxkX2FjdGl2ZScpO1xuICB9XG5cbiAgaGFuZGxlU3Vic2NyaXB0aW9uVGV4dEZpZWxkSW5wdXRCbHVyKCkge1xuICAgIHRoaXMudGV4dEZpZWxkLmNsYXNzTGlzdC5yZW1vdmUoJ3N1YnNjcmlwdGlvbi10ZXh0LWZpZWxkX2FjdGl2ZScpO1xuICB9XG59XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1zdWJzY3JpcHRpb24tdGV4dC1maWVsZCcpXG4gIC5mb3JFYWNoKChpKSA9PiBuZXcgU3Vic2NyaXB0aW9uVGV4dEZpZWxkKGkpKTtcblxuIiwiY2xhc3MgTWFza2VkVGV4dEZpZWxkIHtcbiAgY29uc3RydWN0b3IoaW5wdXQpIHtcbiAgICB0aGlzLmlucHV0ID0gaW5wdXQ7XG4gICAgdGhpcy50ZW1wbGF0ZSA9ICczMS4xMi4yMDk5JztcbiAgICB0aGlzLmluZGV4ID0gLTE7XG4gICAgdGhpcy5wcmVwVmFsdWUgPSAnJztcbiAgICB0aGlzLmFtb3VudFBvaW50cyA9IDA7XG4gICAgdGhpcy50ZW1wbGF0ZVZhbHVlID0gJyc7XG4gICAgdGhpcy5pbnB1dFZhbHVlID0gJyc7XG4gICAgdGhpcy5iaW5kTGlzdGVuZXJzKCk7XG4gIH1cblxuICBiaW5kTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZVRleHRGaWVsZElucHV0LmJpbmQodGhpcykpO1xuICB9XG5cbiAgaGFuZGxlVGV4dEZpZWxkSW5wdXQoKSB7XG4gICAgY29uc3QgZGlmZiA9IHRoaXMuZ2V0VmFsdWVJbmRleCgpIC0gdGhpcy5pbmRleDtcbiAgICBjb25zdCBsYXN0U3ltYiA9IHRoaXMuaW5wdXQudmFsdWUuc2xpY2UoLTEpO1xuICAgIGlmIChkaWZmID4gMCkgeyB0aGlzLnByb2Nlc3NJbnB1dChsYXN0U3ltYik7IH1cbiAgICBpZiAoZGlmZiA8IDAgJiYgISgvXFxkLykudGVzdChsYXN0U3ltYikpIHsgdGhpcy5yZW1vdmVMYXN0Q2hhcmFjdGVyKCk7IH1cbiAgICB0aGlzLmluZGV4ID0gdGhpcy5nZXRWYWx1ZUluZGV4KCk7XG4gIH1cblxuICBwcm9jZXNzSW5wdXQoc3ltYikge1xuICAgIHRoaXMudXBkYXRlVmFsdWVzKCk7XG4gICAgaWYgKC9cXGQvLnRlc3Qoc3ltYikpIHsgXG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVEaWdpdCgpO1xuICAgIH1cbiAgICBpZiAoc3ltYiA9PSAnLicpIHsgXG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVQb2ludCgpO1xuICAgIH1cbiAgICBpZiAoc3ltYiA9PSAnICcpIHtcbiAgICAgIHJldHVybiB0aGlzLmF1dG9jb21wbGV0ZSgpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUxhc3RDaGFyYWN0ZXIoKTtcbiAgfVxuXG4gIHVwZGF0ZVZhbHVlcygpIHtcbiAgICB0aGlzLnByZXBWYWx1ZSA9IHRoaXMudHJpbU5vbkRpZ2l0KHRoaXMuaW5wdXQudmFsdWUpO1xuICAgIHRoaXMuYW1vdW50UG9pbnRzID0gKHRoaXMucHJlcFZhbHVlLm1hdGNoKC9cXC4vZykgfHwgW10pLmxlbmd0aDtcbiAgICB0aGlzLnRlbXBsYXRlVmFsdWUgPSB0aGlzLmdldFZhbHVlKHRoaXMudGVtcGxhdGUpW3RoaXMuYW1vdW50UG9pbnRzXTtcbiAgICB0aGlzLmlucHV0VmFsdWUgPSB0aGlzLmdldFZhbHVlKHRoaXMucHJlcFZhbHVlKS5wb3AoKTtcbiAgfVxuXG4gIGhhbmRsZURpZ2l0KCkge1xuICAgIGlmICh0aGlzLnRlbXBsYXRlW3RoaXMuZ2V0VmFsdWVJbmRleCgpXSA9PSAnLicpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHRoaXMuY29uY2F0U3RyaW5nKFxuICAgICAgICAuLi50aGlzLnNwbGl0U3RyaW5nKHRoaXMuaW5wdXQudmFsdWUsIHRoaXMuZ2V0VmFsdWVJbmRleCgpKSxcbiAgICAgICAgJy4nXG4gICAgICApKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdGhpcy5pbnB1dFZhbHVlLmxlbmd0aCA9PSB0aGlzLnRlbXBsYXRlVmFsdWUubGVuZ3RoIFxuICAgICAgJiYgK3RoaXMuaW5wdXRWYWx1ZSA9PSAwXG4gICAgKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXRWYWx1ZShcbiAgICAgICAgdGhpcy5wcmVwVmFsdWUuc2xpY2UoMCwgdGhpcy5wcmVwVmFsdWUubGFzdEluZGV4T2YodGhpcy5pbnB1dFZhbHVlKSlcbiAgICAgICAgKyB0aGlzLmlucHV0VmFsdWUuc2xpY2UoMCwgLTEpXG4gICAgICAgICsgJzEnXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoK3RoaXMuaW5wdXRWYWx1ZSA+ICt0aGlzLnRlbXBsYXRlVmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKFxuICAgICAgICB0aGlzLnByZXBWYWx1ZS5zbGljZSgwLCB0aGlzLnByZXBWYWx1ZS5sYXN0SW5kZXhPZih0aGlzLmlucHV0VmFsdWUpKVxuICAgICAgICArIHRoaXMudGVtcGxhdGVWYWx1ZVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVQb2ludCgpIHtcbiAgICBpZiAoK3RoaXMuaW5wdXRWYWx1ZSA+ICt0aGlzLnRlbXBsYXRlVmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKFxuICAgICAgICB0aGlzLnByZXBWYWx1ZS5zbGljZSgwLCAtdGhpcy50ZW1wbGF0ZVZhbHVlLmxlbmd0aCkgXG4gICAgICAgICsgdGhpcy50ZW1wbGF0ZVZhbHVlIFxuICAgICAgICArICcuJ1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT0gMCB8fCB0aGlzLnRlbXBsYXRlVmFsdWUubGVuZ3RoID09IDQpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHRoaXMucHJlcFZhbHVlKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT0gMSAmJiB0aGlzLnRlbXBsYXRlVmFsdWUubGVuZ3RoID09IDIpIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZFplcm8oKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT0gMikge1xuICAgICAgdGhpcy5zZXRMYXN0UG9pbnQoKTtcbiAgICB9XG4gIH1cblxuICBhdXRvY29tcGxldGUoKSB7XG4gICAgaWYgKHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT0gMSAmJiB0aGlzLnRlbXBsYXRlVmFsdWUubGVuZ3RoID09IDIpIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZFplcm8oKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaW5wdXRWYWx1ZS5sZW5ndGggPT0gdGhpcy50ZW1wbGF0ZVZhbHVlLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0TGFzdFBvaW50KCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnRlbXBsYXRlVmFsdWUubGVuZ3RoID09IDQgJiYgdGhpcy5pbnB1dFZhbHVlLmxlbmd0aCA9PSAyKSB7XG4gICAgICByZXR1cm4gK3RoaXMuaW5wdXRWYWx1ZSA+IDIxXG4gICAgICAgID8gdGhpcy55ZWFyQXV0b2NvbXBsZXRlKCcxOScpXG4gICAgICAgIDogdGhpcy55ZWFyQXV0b2NvbXBsZXRlKCcyMCcpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUxhc3RDaGFyYWN0ZXIoKTtcbiAgfVxuXG4gIHNldExhc3RQb2ludCgpIHtcbiAgICByZXR1cm4gdGhpcy5zZXRWYWx1ZSh0aGlzLnByZXBWYWx1ZSArICcuJyk7XG4gIH1cblxuICBhZGRaZXJvKCkge1xuICAgIHJldHVybiB0aGlzLnNldFZhbHVlKChcbiAgICAgIHRoaXMuaW5wdXRWYWx1ZSA9PSAnMCcgXG4gICAgICAgID8gdGhpcy5wcmVwVmFsdWUgKyAnMSdcbiAgICAgICAgOiB0aGlzLmNvbmNhdFN0cmluZyhcbiAgICAgICAgICAuLi50aGlzLnNwbGl0U3RyaW5nKHRoaXMucHJlcFZhbHVlLCB0aGlzLnByZXBWYWx1ZS5sZW5ndGggLSAxKSxcbiAgICAgICAgICAnMCdcbiAgICAgICAgKSBcbiAgICApICsgJy4nKTtcbiAgfVxuXG4gIGdldFZhbHVlSW5kZXgoKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5wdXQudmFsdWUubGVuZ3RoIC0gMTtcbiAgfVxuXG4gIHNldFZhbHVlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIHNwbGl0U3RyaW5nKHN0ciwgcG9zKSB7XG4gICAgcmV0dXJuIFtzdHIuc2xpY2UoMCwgcG9zKSwgc3RyLnNsaWNlKHBvcyldO1xuICB9XG5cbiAgY29uY2F0U3RyaW5nKHN0YXJ0LCBlbmQsIHN5bWJvbCA9ICcnKSB7XG4gICAgcmV0dXJuIHN0YXJ0ICsgc3ltYm9sICsgZW5kO1xuICB9XG5cbiAgdHJpbU5vbkRpZ2l0KHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvW15cXGRdKyQvLCAnJyk7XG4gIH1cblxuICByZW1vdmVMYXN0Q2hhcmFjdGVyKCkge1xuICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHRoaXMuaW5wdXQudmFsdWUuc2xpY2UoMCwgLTEpKTtcbiAgfVxuXG4gIGdldFZhbHVlKHN0cikge1xuICAgIHJldHVybiBzdHIubWF0Y2goL1teLl0rKD89XFwufCQpL2cpIHx8IFsnJ107XG4gIH1cblxuICB5ZWFyQXV0b2NvbXBsZXRlKHNob3J0WWVhcikge1xuICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHRoaXMuY29uY2F0U3RyaW5nKFxuICAgICAgLi4udGhpcy5zcGxpdFN0cmluZyhcbiAgICAgICAgdGhpcy5wcmVwVmFsdWUsIHRoaXMucHJlcFZhbHVlLmxhc3RJbmRleE9mKHRoaXMuaW5wdXRWYWx1ZSlcbiAgICAgICksXG4gICAgICBzaG9ydFllYXJcbiAgICApKTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtdGV4dC1maWVsZF9tYXNrZWQnKVxuICAuZm9yRWFjaCgoaW5wdXQpID0+IG5ldyBNYXNrZWRUZXh0RmllbGQoaW5wdXQpKTtcblxuIiwiLyogZXNsaW50LWRpc2FibGUgKi9cbihyKSA9PiAoXG4gIHIua2V5cygpLmZpbHRlcigoaykgPT4gIWsuaW5jbHVkZXMoJ2NhbCcpKS5mb3JFYWNoKChrKSA9PiByKGspKVxuKShyZXF1aXJlLmNvbnRleHQoJ0BsaWJyYXJ5LycsIHRydWUsIC9cXC5zYXNzJC8pKTtcblxuIiwiaW1wb3J0ICdAc3JjL3BhZ2VzL3VpLWtpdC9mb3JtLWVsZW1lbnRzL2Zvcm0tZWxlbWVudHMuc2Fzcyc7XG5cbmltcG9ydCBpbXBvcnRBbGwgZnJvbSAnQHNyYy9jb21tb24uc2NyaXB0cy9pbXBvcnRBbGwuanMnO1xuXG5pbXBvcnRBbGwoKTtcblxuIl0sInNvdXJjZVJvb3QiOiIifQ==